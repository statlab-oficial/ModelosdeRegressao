<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt-BR" xml:lang="pt-BR"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Laboratório de Inovação em Estatística - StatLab">

<title>Análise de Regressão: Teoria e Prática - 4&nbsp; Verificação dos Pressupostos</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./diag.html" rel="next">
<link href="./reg.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script>
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.33/datatables.js"></script>
<script src="site_libs/jquery-3.6.1/jquery-3.6.1.min.js"></script>
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./pres.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Verificação dos Pressupostos</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Análise de Regressão: Teoria e Prática</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Procurar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefácio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introdução</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preliminares.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Preliminares</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Análise de Regressão</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pres.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Verificação dos Pressupostos</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./diag.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Análise de Diagnóstico</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Índice</h2>
   
  <ul>
  <li><a href="#multicolinearidade-o-que-acontece-se-os-regressores-estiverem-correlacionados" id="toc-multicolinearidade-o-que-acontece-se-os-regressores-estiverem-correlacionados" class="nav-link active" data-scroll-target="#multicolinearidade-o-que-acontece-se-os-regressores-estiverem-correlacionados"><span class="header-section-number">4.1</span> Multicolinearidade: o que acontece se os regressores estiverem correlacionados?</a>
  <ul class="collapse">
  <li><a href="#qual-a-natureza-da-multicolinearidade" id="toc-qual-a-natureza-da-multicolinearidade" class="nav-link" data-scroll-target="#qual-a-natureza-da-multicolinearidade"><span class="header-section-number">4.1.1</span> Qual a natureza da multicolinearidade?</a></li>
  <li><a href="#multicolinearidade-muito-barulho-por-nada-consequências-teóricas-da-multicolinearidade" id="toc-multicolinearidade-muito-barulho-por-nada-consequências-teóricas-da-multicolinearidade" class="nav-link" data-scroll-target="#multicolinearidade-muito-barulho-por-nada-consequências-teóricas-da-multicolinearidade"><span class="header-section-number">4.1.2</span> Multicolinearidade: muito barulho por nada? Consequências teóricas da multicolinearidade</a></li>
  <li><a href="#multicolinearidade-muito-barulho-por-nada-consequências-teóricas-da-multicolinearidade-1" id="toc-multicolinearidade-muito-barulho-por-nada-consequências-teóricas-da-multicolinearidade-1" class="nav-link" data-scroll-target="#multicolinearidade-muito-barulho-por-nada-consequências-teóricas-da-multicolinearidade-1"><span class="header-section-number">4.1.3</span> Multicolinearidade: muito barulho por nada? Consequências teóricas da multicolinearidade</a></li>
  <li><a href="#medidas-corretivas" id="toc-medidas-corretivas" class="nav-link" data-scroll-target="#medidas-corretivas"><span class="header-section-number">4.1.4</span> Medidas corretivas</a></li>
  </ul></li>
  <li><a href="#heterocedasticidade-o-que-acontece-se-os-regressores-se-a-variância-do-erro-não-é-constante" id="toc-heterocedasticidade-o-que-acontece-se-os-regressores-se-a-variância-do-erro-não-é-constante" class="nav-link" data-scroll-target="#heterocedasticidade-o-que-acontece-se-os-regressores-se-a-variância-do-erro-não-é-constante"><span class="header-section-number">4.2</span> Heterocedasticidade: o que acontece se os regressores se a variância do erro não é constante?</a>
  <ul class="collapse">
  <li><a href="#a-natureza-da-heterocedasticidade" id="toc-a-natureza-da-heterocedasticidade" class="nav-link" data-scroll-target="#a-natureza-da-heterocedasticidade"><span class="header-section-number">4.2.1</span> A natureza da heterocedasticidade</a></li>
  <li><a href="#detecção-da-heterocedasticidade" id="toc-detecção-da-heterocedasticidade" class="nav-link" data-scroll-target="#detecção-da-heterocedasticidade"><span class="header-section-number">4.2.2</span> Detecção da heterocedasticidade</a></li>
  </ul></li>
  <li><a href="#autocorrelação-o-que-acontece-se-os-termos-de-erro-são-correlacionados" id="toc-autocorrelação-o-que-acontece-se-os-termos-de-erro-são-correlacionados" class="nav-link" data-scroll-target="#autocorrelação-o-que-acontece-se-os-termos-de-erro-são-correlacionados"><span class="header-section-number">4.3</span> Autocorrelação: o que acontece se os termos de erro são correlacionados?</a>
  <ul class="collapse">
  <li><a href="#consequências-do-uso-dos-mqo-na-presença-de-autocorrelação" id="toc-consequências-do-uso-dos-mqo-na-presença-de-autocorrelação" class="nav-link" data-scroll-target="#consequências-do-uso-dos-mqo-na-presença-de-autocorrelação"><span class="header-section-number">4.3.1</span> Consequências do uso dos MQO na presença de autocorrelação</a></li>
  <li><a href="#o-que-fazer-ao-deparar-se-com-a-autocorrelação-medidas-corretivas" id="toc-o-que-fazer-ao-deparar-se-com-a-autocorrelação-medidas-corretivas" class="nav-link" data-scroll-target="#o-que-fazer-ao-deparar-se-com-a-autocorrelação-medidas-corretivas"><span class="header-section-number">4.3.2</span> O que fazer ao deparar-se com a autocorrelação: medidas corretivas</a></li>
  <li><a href="#correção-da-autocorrelação-pura-o-método-dos-mínimos-quadrados-generalizados-mqg" id="toc-correção-da-autocorrelação-pura-o-método-dos-mínimos-quadrados-generalizados-mqg" class="nav-link" data-scroll-target="#correção-da-autocorrelação-pura-o-método-dos-mínimos-quadrados-generalizados-mqg"><span class="header-section-number">4.3.3</span> Correção da autocorrelação (pura): o método dos mínimos quadrados generalizados (MQG)</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Verificação dos Pressupostos</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="multicolinearidade-o-que-acontece-se-os-regressores-estiverem-correlacionados" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="multicolinearidade-o-que-acontece-se-os-regressores-estiverem-correlacionados"><span class="header-section-number">4.1</span> Multicolinearidade: o que acontece se os regressores estiverem correlacionados?</h2>
<p>Umas das hipóteses do modelo clássico de regressão linear afirma que não há <strong>multicolinearidade</strong> entre os regressores incluídos no modelo de regressão. Iremos buscar responder as seguintes perguntas:</p>
<ol type="1">
<li>Qual a natureza da multicolinearidade?</li>
<li>A multicolinearidade é realmente um problema?</li>
<li>Quais são suas consequências práticas?</li>
<li>Como é detectada?</li>
<li>Que medidas podem ser tomadas para atenuar o problema de multicolinearidade?</li>
</ol>
<section id="qual-a-natureza-da-multicolinearidade" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="qual-a-natureza-da-multicolinearidade"><span class="header-section-number">4.1.1</span> Qual a natureza da multicolinearidade?</h3>
<p>O termo <em>multicolinearidade</em> deve-se a Ragnar Frisch. Originalmente, significava a existência de uma relação linear “perfeita” ou exata entre algumas ou todas as variáveis explanatórias do modelo de regressão.</p>
<p>No caso de regressão com <span class="math inline">\(k\)</span> variáveis explanatórias <span class="math inline">\(X_1, X_2, \ldots, X_k\)</span> (em que <span class="math inline">\(X_1 = 1\)</span> para todas as observações, de modo que permita o termo de intercepto), diz-se existir uma relação linear exata se a seguinte condição for satisfeita:</p>
<p><span class="math display">\[\lambda_1 X_1 + \lambda_2 X_2 + \cdots + \lambda_k X_k = 0,\]</span> em que <span class="math inline">\(\lambda_1, \lambda_2, \ldots, \lambda_k\)</span> são constantes tais que nem todas são simultaneamente zero.</p>
<p>Hoje, no entanto, o termo multicolinearidade é usado em um sentido mais amplo, para incluir o caso de multicolinearidade perfeita, como na equação acima, como o caso em que as variáveis <span class="math inline">\(X\)</span> estão intercorrelacionadas, mas não perfeitamente, como se segue:</p>
<p><span class="math display">\[\lambda_1 X_1 + \lambda_2 X_2 + \cdots + \lambda_k X_k + v_i = 0,\]</span> em que <span class="math inline">\(v_i\)</span> é um termo de erro estocástico.</p>
<p>Por que o modelo clássico de regressão linear pressupõe que não há multicolinearidade entre os <span class="math inline">\(X\)</span>? <em>Se a multicolinearidade for perfeita os coeficientes de regressão serão indeterminados e seus erros padrão, infinitos. Se a multicolinearidade for menos que perfeita, os coeficientes, embora determinados, possuirão grandes erros padrão</em>.</p>
<p>Há várias fontes de multicolinearidade. Como observam Montgomery e Peck, a multicolinearidade pode ocorrer devido aos seguintes fatores:</p>
<ol type="1">
<li><em>O método de coleta de dados empregado</em>;</li>
<li><em>Restrições ao modelo ou à população que está sendo amostrada</em>;</li>
<li><em>Especificação do modelo</em>;</li>
<li><em>Um modelo sobredeterminado</em>.</li>
</ol>
<p>Outra razão para a multicolinearidade, principalmente nos dados de séries temporais, pode ser que os regressores incluídos no modelo tenham uma tendência comum: todos aumentam ou diminuem ao longo do tempo. Na regressão de gastos de consumo sobre renda, riqueza e população, os regressores renda, riqueza e população podem estar crescendo com o tempo, aproximadamente na mesma taxa, gerando colinearidade dessas variáveis.</p>
</section>
<section id="multicolinearidade-muito-barulho-por-nada-consequências-teóricas-da-multicolinearidade" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="multicolinearidade-muito-barulho-por-nada-consequências-teóricas-da-multicolinearidade"><span class="header-section-number">4.1.2</span> Multicolinearidade: muito barulho por nada? Consequências teóricas da multicolinearidade</h3>
<p>Lembre-se de que, se as hipóteses do modelo clássico forem satisfeitas, os estimadores de MQO dos estimadores da regressão serão MELNT (melhores estimadores lineares não viesados) ou MENT (melhores estimadores não viesados) se a hipótese da normalidade for acrescentada. Agora podemos mostrar que, mesmo se a multicolinearidade for muito alta, como no caso da quase multicolinearidade, os estimadores de MQO ainda conservarão a propriedade de melhores estimadores lineares não viesados. Por que toda essa confusão por causa da multicolinearidade? Como Christopher Achen ressalta:</p>
<p>Os alunos que estão começando a estudar metodologia às vezes se preocupam com a correlação de suas variáveis independentes - o chamado problema da multicolinearidade. Mas esta não viola nenhuma das hipóteses de regressão. Estimativas consistentes, não viesadas, resultarão, e seus erros padrão serão estimados corretamente. O único efeito da multicolinearidade é dificultar a obtenção de estimativas dos coeficientes com erros padrão pequenos. Mas ter um pequeno número de observações também gera esse efeito, como ter variáveis independentes com pequenas variâncias. (Na verdade, teoricamente, a multicolinearidade, poucas observações e pequenas variâncias das variáveis independentes são essencialmente o mesmo problema.) Perguntar “O que devo fazer com a multicolinearidade?” é como perguntar “O que devo fazer se não tenho muitas observações?”. Não há resposta estatística para essa pergunta.</p>
<p>Achen, Christopher H. Interpreting and using regression. Beverly Hills, Califórnia: Sage Publications, 1982. p.&nbsp;82-83</p>
<p>Gujarati e Porter (<em>Econometria Básica</em>)</p>
</section>
<section id="multicolinearidade-muito-barulho-por-nada-consequências-teóricas-da-multicolinearidade-1" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="multicolinearidade-muito-barulho-por-nada-consequências-teóricas-da-multicolinearidade-1"><span class="header-section-number">4.1.3</span> Multicolinearidade: muito barulho por nada? Consequências teóricas da multicolinearidade</h3>
<p>Em primeiro lugar, é verdade que, mesmo no caso de quase multicolinearidade, os estimadores de MQO são não viesados, mas a não viesidade é uma propriedade de amostragem repetida ou de multiamostragem. Em outras palavras, mantendo fixos os valores das variáveis <span class="math inline">\(X\)</span>, se obtivermos amostras repetidas e calcularmos os estimadores de MQO para cada uma dessas amostras, a média dos valores da amostra convergirá para os verdadeiros valores populacionais dos estimadores à medida que o número das amostras aumenta. Mas isso não diz nada sobre as propriedades dos estimadores em qualquer amostra dada.</p>
<p>Em segundo lugar, também é verdade que a colinearidade não destrói a propriedade de variância mínima: na classe de todos os estimadores não viesados, os estimadores de MQO têm variância mínima; são eficientes. Contudo não significa que a variância de um estimador de MQO será necessariamente pequena (em relação ao valor do estimador) em qualquer amostra dada.</p>
<p>Terceiro, a multicolinearidade é essencialmente um fenômeno amostral (da regressão) no sentido de que, mesmo que as variáveis <span class="math inline">\(X\)</span> não estejam relacionadas linearmente na população, elas podem estar relacionadas na amostra em questão: quando postulamos a função de regressão populacional ou teórica (FRP), acreditamos que todas as variáveis <span class="math inline">\(X\)</span> incluídas no modelo tenham uma influência separada ou independente sobre a variável dependente <span class="math inline">\(Y\)</span>. Mas pode acontecer que, em qualquer amostra dada que seja usada para testar a FRP, algumas ou todas as variáveis <span class="math inline">\(X\)</span> sejam tão colineares que não podemos isolar sua influência sobre <span class="math inline">\(Y\)</span>. É como se disséssemos que nossa amostra nos decepcionou, embora a teoria informe que todas as variáveis <span class="math inline">\(X\)</span> são importantes. Em resumo, nossa amostra pode não ser “rica” o suficiente para acomodar todas as variáveis <span class="math inline">\(X\)</span> na análise.</p>
<p>Gujarati e Porter (<em>Econometria Básica</em>)</p>
<section id="consequências-práticas-da-multicolinearidade" class="level4" data-number="4.1.3.1">
<h4 data-number="4.1.3.1" class="anchored" data-anchor-id="consequências-práticas-da-multicolinearidade"><span class="header-section-number">4.1.3.1</span> Consequências práticas da multicolinearidade</h4>
<p>Em casos de quase ou de alta multicolinearidade, é muito provável nos depararmos com as seguintes consequências:</p>
<ol type="1">
<li><p>Embora sejam os melhores estimadores lineares não viesados, os estimadores de MQO têm grandes variâncias e covariâncias, tornando difícil uma estimação precisa.</p></li>
<li><p>Devido à consequência 1, os intervalos de confiança tendem a ser muito mais amplos, levando à aceitação imediata da “hipótese nula igual a zero” (isto é, o verdadeiro coeficiente populacional igual a zero).</p></li>
<li><p>Também, devido à consequência 1, a razão <span class="math inline">\(t\)</span> de um ou mais coeficientes tende a ser estatisticamente insignificante.</p></li>
<li><p>Embora a razão <span class="math inline">\(t\)</span> de um ou mais coeficientes seja estatisticamente insignificante, <span class="math inline">\(R^2\)</span> , a medida geral da qualidade do ajustamento, pode ser muito alto.</p></li>
<li><p>Os estimadores de MQO e seus erros padrão podem ser sensíveis a pequenas alterações nos dados.</p></li>
</ol>
<p>Gujarati e Porter (<em>Econometria Básica</em>)</p>
</section>
<section id="exemplo" class="level4" data-number="4.1.3.2">
<h4 data-number="4.1.3.2" class="anchored" data-anchor-id="exemplo"><span class="header-section-number">4.1.3.2</span> Exemplo</h4>
<p>Para ilustrar os pontos destacados até aqui, consideremos o exemplo de consumo-renda. A Tabela abaixo contém dados hipotéticos sobre consumo, renda e riqueza.</p>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-e60780f07616fdf50e2d" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-e60780f07616fdf50e2d">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10"],[70,65,90,95,110,115,120,140,155,150],[80,100,120,140,160,180,200,220,240,260],[810,1009,1273,1425,1633,1876,2052,2201,2435,2686]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Consumo<\/th>\n      <th>Renda<\/th>\n      <th>Riqueza<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-center","targets":3},{"className":"dt-right","targets":[1,2]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Consumo","targets":1},{"name":"Renda","targets":2},{"name":"Riqueza","targets":3}],"pageLength":5,"lengthMenu":[5,10],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Se pressupormos que os gastos de consumo estejam linearmente relacionados à renda e à riqueza, então, na Tabela acima, obteremos a seguinte regressão:</p>
<p>[Gujarati e Porter (<em>Econometria Básica</em>)</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Consumo ~ Renda + Riqueza, data = tabela)

Residuals:
     Min       1Q   Median       3Q      Max 
-11.1120  -4.4767   0.9206   4.1744   7.5844 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept) 24.77473    6.75250   3.669  0.00798 **
Renda        0.94154    0.82290   1.144  0.29016   
Riqueza     -0.04243    0.08066  -0.526  0.61509   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.808 on 7 degrees of freedom
Multiple R-squared:  0.9635,    Adjusted R-squared:  0.9531 
F-statistic:  92.4 on 2 and 7 DF,  p-value: 9.286e-06</code></pre>
</div>
</div>
<p>Os resultados acima mostram que renda e riqueza juntas explicam cerca de 96% da variação na despesa de consumo, e nenhum dos coeficientes angulares é, individualmente, estatisticamente significativo. Além disso, a variável riqueza não só é estatisticamente insignificante, mas também tem o sinal errado. A priori, pode-se esperar uma relação positiva entre consumo e riqueza. Embora <span class="math inline">\(\hat \beta_1\)</span> e <span class="math inline">\(\hat \beta_2\)</span> sejam sejam individualmente insignificantes, do ponto de vista estatístico, se testarmos a hipótese de que <span class="math inline">\(\beta_1 = \beta_2 = 0\)</span> simultaneamente, essa hipótese poderá ser rejeitada ( <span class="math inline">\(F = 92,4\)</span> e <span class="math inline">\(p\)</span>-valor <span class="math inline">\(&lt; 0,001\)</span> ).</p>
<p>Gujarati e Porter (<em>Econometria Básica</em>)</p>
</section>
<section id="detecção-da-multicolinearidade" class="level4" data-number="4.1.3.3">
<h4 data-number="4.1.3.3" class="anchored" data-anchor-id="detecção-da-multicolinearidade"><span class="header-section-number">4.1.3.3</span> Detecção da multicolinearidade</h4>
<p>Uma vez que a multicolinearidade é essencialmente um fenômeno amostral decorrente de grande quantidade de dados não experimentais coletados, não temos um método único para detectá-la ou para medir sua força. O que temos são regras práticas; algumas informais e outras formais, mas, ainda assim regras práticas. Consideremos algumas delas.</p>
<ul>
<li><p><span class="math inline">\(R^2\)</span> alto, mas poucas razões <span class="math inline">\(t\)</span> significativas.</p></li>
<li><p>Altas correlações entre pares de regressores. <em>Outra regra sugerida é que se o coeficiente de correlação entre dois regressores for alto, por exempo, maior que 0,8, a multicolinearidade será um problema sério. O problema desse critério é que, embora altas correlações de ordem zero possam sugerir colinearidade, não é necessário que sejam altas para que exista colinearidade em qualquer caso específico.</em></p></li>
<li><p>Regressões auxiliares. Uma vez que a multicolinearidade surge, porque um ou mais regressores são combinações lineares aproximadas ou exatas dos outros regressores, uma forma de descobrir qual variável <span class="math inline">\(X\)</span> está relacionada a outras variáveis <span class="math inline">\(X\)</span> é fazer a regressão de cada <span class="math inline">\(X_i\)</span> contra as demais variáveis <span class="math inline">\(X\)</span> e calcular o <span class="math inline">\(R^2\)</span> correspondente.</p></li>
<li><p>Diagrama de dispersão. É uma boa prática usar um diagrama de dispersão para verificar como as diversas variáveis estão relacionadas em um modelo de regressão.</p></li>
</ul>
</section>
</section>
<section id="medidas-corretivas" class="level3" data-number="4.1.4">
<h3 data-number="4.1.4" class="anchored" data-anchor-id="medidas-corretivas"><span class="header-section-number">4.1.4</span> Medidas corretivas</h3>
<p>O que podemos fazer se a multicolinearidade for grave? Temos duas opções: (1) não fazer nada; ou (2) seguir alguns procedimentos.</p>
<section id="não-fazer-nada" class="level4" data-number="4.1.4.1">
<h4 data-number="4.1.4.1" class="anchored" data-anchor-id="não-fazer-nada"><span class="header-section-number">4.1.4.1</span> Não fazer nada</h4>
<p>A escola do “deixa pra lá” é expressa por Blanchard, como se segue:</p>
<p>Quando estudantes calculam sua primeira regressão dos mínimos quadrados ordinários (MQO), em geral o primeiro problema que encontram é o da multicolinearidade. Muitos deles concluem que há algo errado no MQO; alguns recorrem a técnicas novas e frequentemente criativas de resolver o problema. Mas, dizemos a eles, isso é um erro. A multicolinearidade é da vontade divina (algo foge ao nosso controle) e não um problema com os MQO ou com uma técnica estatística de modo geral.</p>
<p>Blanchard, O. J. “Comment.” Journal of Business and Economics Statistics, v. 5, p.&nbsp;449-451, 1967.</p>
<p>O que Blanchard está dizendo é que a multicolinearidade é essencialmente um problema de deficiência de dados (de novo, a micronumerosidade) e às vezes não temos escolha sobre os dados disponíveis para análise empírica. Também não podemos dizer que todos os coeficientes em um modelo de regressão sejam estatisticamente insignificantes. Além disso, mesmo que não possamos estimar um ou mais coeficientes de regressão com maior precisão, uma combinação linear deles (função estimável) pode ser estimada com relativa eficiência.</p>
</section>
<section id="procedimentos" class="level4" data-number="4.1.4.2">
<h4 data-number="4.1.4.2" class="anchored" data-anchor-id="procedimentos"><span class="header-section-number">4.1.4.2</span> Procedimentos</h4>
<p>Podemos tentar seguir as regras práticas para resolver o problema da multicolinearidade; o sucesso dependerá da gravidade do problema de colinearidade.</p>
<ul>
<li><p>Uma informação a priori. Como obtemos uma informação a priori? Ela poderia vir de trabalho empírico feito anteriormente, em que o problema da colinearidade é menos grave, ou da teoria relevante de nossa área de estudo.</p></li>
<li><p>Exclusão de variável(is) e viés de especificação. Quando nos deparamos com uma multicolinearidade grave, uma das coisas mais “simples” a fazer é excluir uma das variáveis colineares. Mas, ao excluirmos uma variável do modelo, podemos cometer um viés de especificação ou erro de especificação. Este surge de uma especificação incorreta do modelo usado na análise. Se a teoria econômica informa que a renda e a riqueza deveriam, ambas, ser incluídas no modelo que explica gastos de consumo, excluir a variável riqueza constituiria viés de especificação.</p></li>
<li><p>Dados adicionais ou novos: Como a multicolinearidade é um aspecto da amostra, é possível que, em outra amostra envolvendo as mesmas variáveis, a colinearidade possa não ser tão grave quanto na primeira. Às vezes aumentar o tamanho da amostra (se possível) pode atenuar o problema da colinearidade.</p></li>
</ul>
<p>Outros métodos de remediar a multicolinearidade. Técnicas estatísticas multivariadas como a análise de fator e componentes principais ou técnicas como a regressão ridge são empregadas com frequência para “resolver” o problema da multicolinaridade.</p>
</section>
<section id="exemplo-1" class="level4" data-number="4.1.4.3">
<h4 data-number="4.1.4.3" class="anchored" data-anchor-id="exemplo-1"><span class="header-section-number">4.1.4.3</span> Exemplo</h4>
<p>Embora coletados originalmente para avaliar a exatidão computacional das estimativas dos mínimos quadrados em vários programas de computador, os dados de Longley tornaram-se o instrumento para ilustrar vários problemas econométricos, inclusive a multicolinearidade. Este conjunto de dados está disponível no <code>R</code> e para carregar o mesmo, basta usar <code>data("longley")</code>. Também é possível usar o pacote <code>gujarati</code>. Para instalar o pacote basta usar <code>devtools::install_github('https://github.com/brunoruas2/gujarati')</code>. As variáveis são: <span class="math inline">\(Y =\)</span> número de pessoas empregadas, em milhares (<code>Employed</code>); <span class="math inline">\(X_1 =\)</span> deflator implícito dos preços no PNB (<code>GNP.deflator</code>); <span class="math inline">\(X_2 =\)</span> PNB (<code>GNP</code>), em milhões de $; <span class="math inline">\(X_3 =\)</span> número de pessoas desempregadas, em milhares (<code>Unemployed</code>) ; <span class="math inline">\(X_4 =\)</span> número de pessoas nas forças armadas (<code>Armed.Forces</code>); <span class="math inline">\(X_5 =\)</span> população não institucionalizada com mais de 14 anos de idade (<code>Population</code>); e <span class="math inline">\(X_6 =\)</span> ano, igual a 1 em 1947, 2 em 1948 e 16 em 1962 (<code>Year</code>).</p>
<p>Suponha agora que nosso objetivo é estudar <span class="math inline">\(Y\)</span> com base nas seis variáveis regressoras. Usando o <code>R</code>, obtemos os seguintes resultados:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"longley"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Employed <span class="sc">~</span> ., <span class="at">data =</span> longley)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Employed ~ ., data = longley)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.41011 -0.15767 -0.02816  0.10155  0.45539 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -3.482e+03  8.904e+02  -3.911 0.003560 ** 
GNP.deflator  1.506e-02  8.492e-02   0.177 0.863141    
GNP          -3.582e-02  3.349e-02  -1.070 0.312681    
Unemployed   -2.020e-02  4.884e-03  -4.136 0.002535 ** 
Armed.Forces -1.033e-02  2.143e-03  -4.822 0.000944 ***
Population   -5.110e-02  2.261e-01  -0.226 0.826212    
Year          1.829e+00  4.555e-01   4.016 0.003037 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3049 on 9 degrees of freedom
Multiple R-squared:  0.9955,    Adjusted R-squared:  0.9925 
F-statistic: 330.3 on 6 and 9 DF,  p-value: 4.984e-10</code></pre>
</div>
</div>
<p>Um exame rápido desses resultados sugeriria que temos o problema de colinearidade, pois o valor de <span class="math inline">\(R^2\)</span> é muito alto, mas metade das variáveis são estatisticamente insignificantes ( <span class="math inline">\(X_1\)</span> , <span class="math inline">\(X_2\)</span> e <span class="math inline">\(X_5\)</span>), um sintoma clássico de multicolinearidade. A seguir apresentamos a <em>matriz de correlação</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> longley[, <span class="sc">-</span><span class="dv">7</span>] <span class="co">#excluindo a variavel resposta</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(X)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             GNP.deflator       GNP Unemployed Armed.Forces Population
GNP.deflator    1.0000000 0.9915892  0.6206334    0.4647442  0.9791634
GNP             0.9915892 1.0000000  0.6042609    0.4464368  0.9910901
Unemployed      0.6206334 0.6042609  1.0000000   -0.1774206  0.6865515
Armed.Forces    0.4647442 0.4464368 -0.1774206    1.0000000  0.3644163
Population      0.9791634 0.9910901  0.6865515    0.3644163  1.0000000
Year            0.9911492 0.9952735  0.6682566    0.4172451  0.9939528
                  Year
GNP.deflator 0.9911492
GNP          0.9952735
Unemployed   0.6682566
Armed.Forces 0.4172451
Population   0.9939528
Year         1.0000000</code></pre>
</div>
</div>
<p>Várias das correlações acima são muito altas, sugerindo que pode haver um problema grave de colinearidade. Importante lembrar que essas correlações entre pares de variáveis podem ser uma condição suficiente, mas não necessária, para a existência de multicolinearidade.</p>
<p>Para entendermos a natureza do problema da multicolinearidade, efetuemos as regressões auxiliares, que são as regressão de cada variáveis <span class="math inline">\(X\)</span> contra as variáveis <span class="math inline">\(X\)</span> remanescentes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mctest)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">imcdiag</span>(fit, <span class="at">method =</span> <span class="st">"Klein"</span>)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
imcdiag(mod = fit, method = "Klein")


 Klein Multicollinearity Diagnostics

                R2j R2(overall) Difference detection
GNP.deflator 0.9926      0.9955    -0.0029         0
GNP          0.9994      0.9955     0.0040         1
Unemployed   0.9703      0.9955    -0.0252         0
Armed.Forces 0.7214      0.9955    -0.2741         0
Population   0.9975      0.9955     0.0020         1
Year         0.9987      0.9955     0.0032         1

Multicollinearity may be due to GNP Population Year regressors


1 --&gt; COLLINEARITY is detected by the test 
0 --&gt; COLLINEARITY is not detected by the test

===================================</code></pre>
</div>
</div>
<p>Aplicando a regra prática de Klein, vemos que os valores de <span class="math inline">\(R^2\)</span> obtidos das regressões auxiliares excedem o valor do <span class="math inline">\(R^2\)</span> geral em 3 de 6 regressões auxiliares, novamente sugerindo que de fato os dados de Longley são afetados pelo problema da multicolinearidade</p>
<p>Agora que constatamos um problema de multicolinearidade, que ações “corretivas” podemos tomar? Vamos reconsiderar nosso modelo original. Antes de mais nada, poderíamos expressar o PNB não em termos nominais, mas em termos reais, o que podemos fazer dividindo o PNB nominal pelo deflator implícito dos preços. Em segundo lugar, uma vez que a população não institucionalizada de mais de 14 anos aumenta ao longo do tempo devido ao crescimento populacional natural, ela estará altamente correlacionada com o tempo, a variável <code>Year</code> de nosso modelo. Em vez de mantermos ambas as variáveis, manteremos a variável <code>Population</code> e excluiremos <code>Year</code> . Em terceiro lugar, não há razão contundente para incluir <code>Unemployed</code>, o número de pessoas desempregadas; talvez a taxa de desemprego tivesse sido uma medida melhor das condições do mercado de trabalho. Mas não temos dados sobre elas. Logo, excluiremos a variável <code>Unemployed</code> . Efetuando essas alterações, obtemos os seguintes resultados de regressão:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Employed <span class="sc">~</span> <span class="fu">I</span>(GNP<span class="sc">/</span>GNP.deflator) <span class="sc">+</span> Armed.Forces <span class="sc">+</span> Population, <span class="at">data =</span> longley)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Employed ~ I(GNP/GNP.deflator) + Armed.Forces + 
    Population, data = longley)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.1318 -0.1395  0.0136  0.3063  0.6817 

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         65.720366  10.624808   6.186 4.69e-05 ***
I(GNP/GNP.deflator)  9.736496   1.791552   5.435 0.000151 ***
Armed.Forces        -0.006880   0.003222  -2.135 0.054074 .  
Population          -0.299537   0.141761  -2.113 0.056234 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5354 on 12 degrees of freedom
Multiple R-squared:  0.9814,    Adjusted R-squared:  0.9768 
F-statistic: 211.1 on 3 and 12 DF,  p-value: 1.203e-10</code></pre>
</div>
</div>
<p>Embora o valor de <span class="math inline">\(R^2\)</span> tenha declinado ligeiramente em comparação ao <span class="math inline">\(R^2\)</span> original, ainda é muito alto. Agora, todos os coeficientes estimados são significativos e os sinais dos coeficientes fazem sen- tido, do ponto de vista econômico.</p>
<blockquote class="blockquote">
<p>Agora é com você! Crie seu próprio modelo alternativo.</p>
</blockquote>
</section>
</section>
</section>
<section id="heterocedasticidade-o-que-acontece-se-os-regressores-se-a-variância-do-erro-não-é-constante" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="heterocedasticidade-o-que-acontece-se-os-regressores-se-a-variância-do-erro-não-é-constante"><span class="header-section-number">4.2</span> Heterocedasticidade: o que acontece se os regressores se a variância do erro não é constante?</h2>
<p>Uma hipótese importante do modelo clássico de regressão linear é que os termos de erro <span class="math inline">\(\epsilon_i\)</span> que aparecem na função de regressão populacional são homocedásticos; ou seja, todos têm a mesma variância. Examinaremos a validade dessa hipótese e descobriremos o que acontece quando ela não é constatada. Buscamos respostas às seguintes questões:</p>
<ol type="1">
<li><p>Qual a natureza da heterocedasticidade?</p></li>
<li><p>Quais suas consequências?</p></li>
<li><p>Como é detectada?</p></li>
<li><p>Quais as medidas corretivas?</p></li>
</ol>
<section id="a-natureza-da-heterocedasticidade" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="a-natureza-da-heterocedasticidade"><span class="header-section-number">4.2.1</span> A natureza da heterocedasticidade</h3>
<p>Várias são as razões para as variâncias de <span class="math inline">\(\epsilon_i\)</span> poderem ser variáveis, algumas das quais são dadas a seguir:</p>
<ol type="1">
<li><p>Seguindo os <em>modelos de erro-aprendizagem</em>, comportamentos incorretos das pessoas diminuem com o tempo ou o número de erros torna-se mais consistente. Neste caso, espera-se que <span class="math inline">\(\sigma^2\)</span> diminua.</p></li>
<li><p>A heterocedasticidade também ocorre como resultado da presença de dados discrepantes (outliers).</p></li>
<li><p>Outra fonte de heterocedasticidade surge da violação da suposição de que o modelo está especificado corretamente.</p></li>
<li><p>Outra fonte de heterocedasticidade é a assimetria na distribuição de um ou mais regressores incluídos no modelo.</p></li>
<li><p>Outras fontes de heterocedasticidade: como David Hendry observa, a heterocedasticidade também pode surgir (1) da transformação incorreta de dados (por exemplo, transformações proporcionais ou de primeira diferença) e (2) da forma funcional incorreta (por exemplo, modelos lineares versus log-lineares).</p></li>
</ol>
</section>
<section id="detecção-da-heterocedasticidade" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="detecção-da-heterocedasticidade"><span class="header-section-number">4.2.2</span> Detecção da heterocedasticidade</h3>
<section id="métodos-informais" class="level4" data-number="4.2.2.1">
<h4 data-number="4.2.2.1" class="anchored" data-anchor-id="métodos-informais"><span class="header-section-number">4.2.2.1</span> Métodos informais</h4>
<ul>
<li><p><strong>Natureza do problema</strong>. Com muita frequência, a natureza do problema em consideração sugere a probabilidade de encontrarmos heterocedasticidade. Por exemplo, seguindo o trabalho pioneiro de Prais e Houthakker sobre estudos de orçamentos familiares, em que verificaram que a variância residual em torno da regressão de consumo sobre a renda aumentava com a renda, agora se supõe, de modo geral, que em estudos semelhantes pode-se esperar variâncias desiguais entre os termos de erro. Na verdade, em dados de corte transversal envolvendo unidades heterogêneas, a heterocedasticidade pode ser a regra e não a exceção. Em uma análise de corte transversal que envolve despesas com investimento em relação a vendas, taxa de juros etc., em geral espera-se encontrar heterocedasticidade se empresas de tamanho pequeno, médio e grande fizerem parte da amostra.</p></li>
<li><p><strong>Método gráfico</strong>. Gráficos de <span class="math inline">\(\hat \epsilon_i\)</span> contra <span class="math inline">\(\hat Y_i\)</span> para descobrir se o valor médio estimado de <span class="math inline">\(Y\)</span> está sistematicamente relacionado aos resíduos elevados ao quadrado. Em vez de traçar <span class="math inline">\(\hat \epsilon_i\)</span> contra <span class="math inline">\(\hat Y_i\)</span> pode-se traçá-los contra uma das variáveis explanatórias.</p></li>
</ul>
</section>
<section id="métodos-formais" class="level4" data-number="4.2.2.2">
<h4 data-number="4.2.2.2" class="anchored" data-anchor-id="métodos-formais"><span class="header-section-number">4.2.2.2</span> Métodos formais</h4>
<ul>
<li>Teste de Park.</li>
<li>Teste de Glejser.</li>
<li>Teste de Goldfeld-Quandt.</li>
<li>Teste de Breusch-Pagan-Godfrey</li>
<li>Teste de White.</li>
</ul>
<section id="teste-de-park" class="level5" data-number="4.2.2.2.1">
<h5 data-number="4.2.2.2.1" class="anchored" data-anchor-id="teste-de-park"><span class="header-section-number">4.2.2.2.1</span> Teste de Park</h5>
<p>Park formaliza o método gráfico sugerindo que <span class="math inline">\(\sigma^2\)</span> seja uma função da variável explanatória <span class="math inline">\(X_i\)</span>. A forma funcional sugerida por ele é</p>
<p><span class="math display">\[\sigma_i^2 = \sigma^2 X_i^\beta e^{\nu_i},\]</span> ou</p>
<p><span class="math display">\[\log(\sigma_i^2) = \log(\sigma^2) + \beta \log(X_i) + \nu_i,\]</span> em que <span class="math inline">\(\nu_i\)</span> é o termo de erro estocástico.</p>
<p>Uma vez que <span class="math inline">\(\sigma_i^2\)</span> em geral não é conhecido, Park sugere usar <span class="math inline">\(\hat\epsilon_i^2\)</span> como <em>proxy</em> e calcular a seguinte regressão:</p>
<p><span class="math display">\[\log(\hat\epsilon_i^2) = \log(\sigma^2) + \beta \log(X_i) + \nu_i = \alpha + \beta \log(X_i) + \nu_i.\]</span></p>
<p>Se <span class="math inline">\(\beta\)</span> for significativo estatisticamente, isso sugere que a heterocedasticidade está presente nos dados. Se nao for significativo, não rejeitamos a hipótese da homocedasticidade. O teste de Park é um procesimento que envolve duas etapas. Na primeira fazemos a regressão de MQO desconsiderando a questão da heterocedasticidade. Obtemos <span class="math inline">\(\hat\epsilon_i\)</span> dessa regressão, então na segunda etapa fazemos a regressão dos residuos contra <span class="math inline">\(X\)</span>.</p>
</section>
</section>
<section id="exemplo-2" class="level4" data-number="4.2.2.3">
<h4 data-number="4.2.2.3" class="anchored" data-anchor-id="exemplo-2"><span class="header-section-number">4.2.2.3</span> Exemplo</h4>
<p>Para ilustrar a abordagem de Park, usamos a seguinte regressão:</p>
<p><span class="math display">\[Y_i = \beta_0 + \beta_1 X_i + \epsilon_i,\]</span> em que <span class="math inline">\(Y =\)</span> remuneração média em milhares de dólares, <span class="math inline">\(X =\)</span> produtividade média em milhares de dólares e <span class="math inline">\(i =\)</span> <span class="math inline">\(i\)</span>-ésimo tamanho do emprego de estabelecimento. Os resultados são os seguintes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>remuneracao_media <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3396</span>, <span class="dv">3787</span>, <span class="dv">4013</span>, <span class="dv">4104</span>, <span class="dv">4146</span>, <span class="dv">4241</span>, <span class="dv">4388</span>, <span class="dv">4538</span>, <span class="dv">4843</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>produtividade_media <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">9355</span>, <span class="dv">8584</span>, <span class="dv">7962</span>, <span class="dv">8275</span>, <span class="dv">8389</span>, <span class="dv">9418</span>, <span class="dv">9795</span>, <span class="dv">10281</span>, <span class="dv">11750</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(remuneracao_media <span class="sc">~</span> produtividade_media); <span class="fu">summary</span>(fit2)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = remuneracao_media ~ produtividade_media)

Residuals:
    Min      1Q  Median      3Q     Max 
-775.77   54.55  113.71  165.80  199.31 

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)         1.992e+03  9.366e+02   2.127   0.0710 .
produtividade_media 2.330e-01  9.985e-02   2.333   0.0523 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 337.3 on 7 degrees of freedom
Multiple R-squared:  0.4375,    Adjusted R-squared:  0.3572 
F-statistic: 5.445 on 1 and 7 DF,  p-value: 0.05235</code></pre>
</div>
</div>
<p>Os resultados revelam que o coeficiente angular estimado é significante no nível de 10%. A equação mostra que, quando a produtividade no trabalho aumenta em, por exemplo, um dólar, a remuneração da mão de obra aumenta em média 23 centavos.</p>
<p>Então, calcula-se a regressão dos resíduos obtidos na regressão contra <span class="math inline">\(X_i\)</span>. Temos os resultados a seguir:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>logu2 <span class="ot">&lt;-</span> <span class="fu">log</span>(fit2<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>logx <span class="ot">&lt;-</span> <span class="fu">log</span>(produtividade_media)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(logu2 <span class="sc">~</span> logx)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit3)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = logu2 ~ logx)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.18904 -0.43633 -0.10916  0.08593  3.10162 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   35.827     38.323   0.935    0.381
logx          -2.802      4.196  -0.668    0.526

Residual standard error: 1.467 on 7 degrees of freedom
Multiple R-squared:  0.05989,   Adjusted R-squared:  -0.07442 
F-statistic: 0.4459 on 1 and 7 DF,  p-value: 0.5257</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Não há relação estatisticamente significativa entre as duas variáveis. Seguindo o teste de Park, pode-se concluir que não há heterocedasticidade na variância dos erros.</p>
</blockquote>
<p>Agora iremos considerar o conjunto de dados <code>hprice1</code> do pacote <code>{wooldridge}</code> do <code>R</code>. Este conjunto de dados foi apresentado nos slides da <a href="https://rpubs.com/santosneto/slides_semana11">semana 11</a> do curso. Como mencionado no slide 2 estes dados devem ser usados na realização da atividade prática final da disciplina. Para ajudar nesta atividade irei apresentar uma pequena análise prévia deste conjunto de dados. Irei considerar o seguinte modelo:</p>
<p><span class="math display">\[
\text{price} = \beta_0 + \beta_1 \, \text{lotsize} + \beta_2\, \text{sqrft} + \beta_3\, \text{bdrms} + \epsilon_i,
\]</span> em que <span class="math inline">\(\epsilon_i \sim N(0, \sigma^2)\)</span>, <span class="math inline">\(E(\epsilon_i, \epsilon_j) = 0\; \forall i \neq j\)</span>. Usando a função <code>lm()</code> para ajustar o modelo acima temos</p>
<div class="cell" data-max.height="10px">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wooldridge)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>fit4  <span class="ot">&lt;-</span> <span class="fu">lm</span>(price <span class="sc">~</span> lotsize <span class="sc">+</span> sqrft <span class="sc">+</span> bdrms, <span class="at">data =</span> hprice1); fit4 </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = price ~ lotsize + sqrft + bdrms, data = hprice1)

Coefficients:
(Intercept)      lotsize        sqrft        bdrms  
 -21.770308     0.002068     0.122778    13.852522  </code></pre>
</div>
</div>
<p>Agora iremos utilizar o teste de Breusch-Pagan para verificar a presença de heterocedasticidade. Para isso, basta usar a função <code>bptest()</code> do pacote <code>{lmtest}</code>. Vejamos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Carregando pacotes exigidos: zoo</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Anexando pacote: 'zoo'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Os seguintes objetos são mascarados por 'package:base':

    as.Date, as.Date.numeric</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>bp <span class="ot">&lt;-</span> <span class="fu">bptest</span>(fit4); bp</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  fit4
BP = 14.092, df = 3, p-value = 0.002782</code></pre>
</div>
</div>
<p>A estatística de teste é 14,092 e o correspondente <span class="math inline">\(p\)</span>-valor é 0,003. Se consideramos um nível de significância de <span class="math inline">\(1\%\)</span>, nós rejeitamos a hipótese nula, ou seja, temos fortes evidências contra a hipótese de homocedasticidade.</p>
<p>Um benefício de usar a forma funcional logarítmica para a variável dependente é que a heterocedasticidade é frequentemente reduzida. Neste exeplo, iremos considerar também as variáveis <code>lotsize</code> e <code>sqrft</code> na forma logarítmica. Estas transformações já estão presentes no conjunto de dados do <code>R</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>fit5  <span class="ot">&lt;-</span> <span class="fu">lm</span>(lprice <span class="sc">~</span> llotsize <span class="sc">+</span> lsqrft <span class="sc">+</span> bdrms, <span class="at">data =</span> hprice1); fit5 </span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = lprice ~ llotsize + lsqrft + bdrms, data = hprice1)

Coefficients:
(Intercept)     llotsize       lsqrft        bdrms  
   -1.29704      0.16797      0.70023      0.03696  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(fit5)</span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  fit5
BP = 4.2232, df = 3, p-value = 0.2383</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Portanto, não rejeitamos a hipótese nula de homocedasticidade no modelo com as formas funcionais logarítmicas.</p>
</blockquote>
</section>
</section>
</section>
<section id="autocorrelação-o-que-acontece-se-os-termos-de-erro-são-correlacionados" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="autocorrelação-o-que-acontece-se-os-termos-de-erro-são-correlacionados"><span class="header-section-number">4.3</span> Autocorrelação: o que acontece se os termos de erro são correlacionados?</h2>
<p>A autocorrelação pode ser definida como “correlação entre integrantes de séries de observações ordenadas no tempo [como as séries temporais] ou no espaço [como nos dados de corte transversal]”. No contexto da regressão, o modelo clássico de regressão linear pressupõe que essa autocorrelação não existe nos termos de erro <span class="math inline">\(\epsilon_i\)</span> . Simbolicamente</p>
<p><span class="math display">\[cov(\epsilon_i, \epsilon_j| x_i, x_j) = E(\epsilon_i, \epsilon_j) = 0, \quad i \neq j.\]</span> Em outras palavras, o modelo clássico pressupõe que o termo de erro relacionado a qualquer uma das observações não é influenciado pelo termo de erro de qualquer outra observação.</p>
<p>Contudo, se for verificada essa dependência, teremos autocorrelação. Simbolicamente</p>
<p><span class="math display">\[E(\epsilon_i, \epsilon_j) \neq 0, \quad i \neq j.\]</span> Em tal situação, a perturbação provocada por uma greve neste trimestre pode afetar a produção do próximo, ou os aumentos da despesa de uma família podem levar outra a aumentar seu consumo para não ficar para trás.</p>
<section id="consequências-do-uso-dos-mqo-na-presença-de-autocorrelação" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="consequências-do-uso-dos-mqo-na-presença-de-autocorrelação"><span class="header-section-number">4.3.1</span> Consequências do uso dos MQO na presença de autocorrelação</h3>
<p>Podemos declarar que um coeficiente é estatisticamente igual a zero, embora na realidade possa não ser.</p>
<section id="detecção-de-autocorrelação" class="level4" data-number="4.3.1.1">
<h4 data-number="4.3.1.1" class="anchored" data-anchor-id="detecção-de-autocorrelação"><span class="header-section-number">4.3.1.1</span> Detecção de autocorrelação</h4>
<ol type="1">
<li>Método gráfico - podemos plotar os resíduos padronizados contra o tempo.</li>
<li>O teste das carreiras, também conhecido como teste de Geary, um teste não paramétrico.</li>
<li>O teste <span class="math inline">\(d\)</span> de Durbin-Watson.</li>
<li>Um teste geral de autocorrelação: o teste de Breusch-Godfrey (BG).</li>
</ol>
</section>
</section>
<section id="o-que-fazer-ao-deparar-se-com-a-autocorrelação-medidas-corretivas" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="o-que-fazer-ao-deparar-se-com-a-autocorrelação-medidas-corretivas"><span class="header-section-number">4.3.2</span> O que fazer ao deparar-se com a autocorrelação: medidas corretivas</h3>
<p>Se, depois de aplicarmos um ou mais testes diagnósticos de autocorrelação discutidos na seção anterior, verificamos a presença dela, o que fazer? Temos quatro opções:</p>
<ol type="1">
<li><p>Tentar verificar se é um caso de autocorrelação pura e não o resultado da especificação equivocada do modelo. Às vezes observamos padrões em resíduos, porque o modelo é mal especificado - ou seja, excluiu algumas variáveis importantes - ou porque sua forma funcional é incorreta.</p></li>
<li><p>Se for autocorrelação pura, podemos usar a transformação adequada do modelo original de modo que, no modelo transformado não tenhamos o problema de autocorrelação (pura). Como no caso de heterocedasticidade, teremos de usar algum tipo de método de mínimos quadrados generalizados (MQG).</p></li>
<li><p>Em amostras grandes, podemos usar o método de Newey-West para obter os erros padrão dos estimadores de MQO que estão corrigidos para a autocorrelação. Esse método na verdade é uma extensão do de erros padrão consistentes para heterocedastividade de White;</p></li>
<li><p>Em algumas situações podemos continuar a usar o método dos MQO.</p></li>
</ol>
</section>
<section id="correção-da-autocorrelação-pura-o-método-dos-mínimos-quadrados-generalizados-mqg" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="correção-da-autocorrelação-pura-o-método-dos-mínimos-quadrados-generalizados-mqg"><span class="header-section-number">4.3.3</span> Correção da autocorrelação (pura): o método dos mínimos quadrados generalizados (MQG)</h3>
<p>Conhecendo as consequências da autocorrelação, principalmente a falta de eficiência dos estimadores, podemos precisar corrigir o problema. A correção depende do conhecimento que se tem da natureza da interdependência entre os termos de erro, ou seja, do conhecimento da estrutura da autocorrelação.</p>
<p>Considere o modelo de regressão de duas variáveis:</p>
<p><span class="math display">\[Y_{t} = \beta_1 + \beta_2 X_{t} + u_{t},\]</span> em que o termo de erro siga o processo AR(1), a saber,</p>
<p><span class="math display">\[u_t = \rho u_{t-1} + \epsilon_t, \quad -1 &lt; \rho &lt; 1.\]</span> Aqui iremos considerar apenas o caso em que <span class="math inline">\(\rho\)</span> é conhecido.</p>
<p>Se a relação funcional do modelo de regressão for verdadeira no tempo <span class="math inline">\(t\)</span>, também será no tempo <span class="math inline">\((t - 1).\)</span> Portanto,</p>
<p><span class="math display">\[Y_{t-1} = \beta_1 + \beta_2 X_{t - 1} + u_{t - 1}.\]</span> Multiplicando a equação acima por <span class="math inline">\(\rho\)</span> em ambos os lados, obtemos</p>
<p><span class="math display">\[\rho Y_{t-1} = \rho\beta_1 + \rho\beta_2 X_{t - 1} + \rho u_{t - 1}.\]</span></p>
<p>Subtraindo a última equação do equação inicial, temos</p>
<p><span class="math display">\[(Y_t - \rho Y_{t-1}) = \beta_1 (1 - \rho) + \beta_2 (X_t - \rho X_{t-1}) + \epsilon_t,\]</span> em que <span class="math inline">\(\epsilon_t = (u_t - \rho u_{t-1})\)</span>. Podemos expressar esta equação como <span class="math display">\[Y^*_{t} = \beta_1^* + \beta_2^* X_t^* + \epsilon_t,\]</span> em que <span class="math inline">\(\beta_1^* = \beta_1(1 - \rho), Y_t^* = (Y_t - \rho Y_{t-1}), X_t^* = (X_t - \rho X_{t -1})\)</span> e <span class="math inline">\(\beta^*_2 = \beta_2\)</span>. Pontanto, podemos aplicar o MQO às variáveis transformadas e obter com todas as propriedades ótimas.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiada");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./reg.html" class="pagination-link" aria-label="Análise de Regressão">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Análise de Regressão</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./diag.html" class="pagination-link" aria-label="Análise de Diagnóstico">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Análise de Diagnóstico</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>