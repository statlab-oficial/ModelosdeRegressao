<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt-BR" xml:lang="pt-BR"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.23">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; O MRLS como Modelo para a Média Condicional</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 1em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./mrls_emq.html" rel="next">
<link href="./part1_ex.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-1fe81d0376b2c50856e68e651e390326.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-70a47bd5681a7291082a5b9f83d58762.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./mrls.html">Parte II — Modelo de Regressão Linear Simples (MRLS)</a></li><li class="breadcrumb-item"><a href="./mrls.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">O MRLS como Modelo para a Média Condicional</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Procurar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Procurar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Informações Legais e Declaração de Uso de Inteligência Artificial</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prefacio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefácio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./identifica.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Identificação da Disciplina</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte I — Modelagem</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introdução e Panorama dos Modelos de Regressão</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelagem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Modelagem Estatística e Regressão</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part1_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exercícios e Atividades de Consolidação</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte II — Modelo de Regressão Linear Simples (MRLS)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mrls.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">O MRLS como Modelo para a Média Condicional</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mrls_emq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Estimação por Mínimos Quadrados no MRLS</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mrls_inferencia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Inferência no MRLS com erros normais</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mrls_testes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Testes de hipóteses e ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mrls_diagnostico.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Diagnóstico e Avaliação no MRLS</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mrls_transf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Transformações nas Variáveis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mrls_compara.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Comparação de Modelos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part2_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Exercícios e Atividades de Consolidação</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte III — Modelo de Regressão Linear Simples (MRLM)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part3_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Exercícios e Atividades de Consolidação</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte IV — Apêndices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ap_listas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Lista de Siglas e Símbolos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ap_matrizes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Estrutura Matricial dos Modelos de Regressão Linear</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ap_normal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Distribuição Normal</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ap_forma_linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Formas Lineares e Quadráticas na Normal Multivariada</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ap_tratamento.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Tratamento de dados para regressão</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part4_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Exercícios e Atividades de Consolidação</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referências</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Índice</h2>
   
  <ul>
  <li><a href="#formulação-matemática-do-mrls" id="toc-formulação-matemática-do-mrls" class="nav-link active" data-scroll-target="#formulação-matemática-do-mrls"><span class="header-section-number">4.1</span> Formulação Matemática do MRLS</a></li>
  <li><a href="#interpretação-dos-parâmetros-e-hipóteses-do-modelo" id="toc-interpretação-dos-parâmetros-e-hipóteses-do-modelo" class="nav-link" data-scroll-target="#interpretação-dos-parâmetros-e-hipóteses-do-modelo"><span class="header-section-number">4.2</span> Interpretação dos Parâmetros e Hipóteses do Modelo</a></li>
  <li><a href="#hipóteses-do-mrls" id="toc-hipóteses-do-mrls" class="nav-link" data-scroll-target="#hipóteses-do-mrls"><span class="header-section-number">4.3</span> Hipóteses do MRLS</a>
  <ul class="collapse">
  <li><a href="#hipóteses-adicionais-para-inferência" id="toc-hipóteses-adicionais-para-inferência" class="nav-link" data-scroll-target="#hipóteses-adicionais-para-inferência"><span class="header-section-number">4.3.1</span> Hipóteses adicionais para inferência</a></li>
  </ul></li>
  <li><a href="#representação-gráfica-e-intuição-geométrica" id="toc-representação-gráfica-e-intuição-geométrica" class="nav-link" data-scroll-target="#representação-gráfica-e-intuição-geométrica"><span class="header-section-number">4.4</span> Representação Gráfica e Intuição Geométrica</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./mrls.html">Parte II — Modelo de Regressão Linear Simples (MRLS)</a></li><li class="breadcrumb-item"><a href="./mrls.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">O MRLS como Modelo para a Média Condicional</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">O MRLS como Modelo para a Média Condicional</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>A compreensão do <strong>Modelo de Regressão Linear Simples (MRLS)</strong> é essencial para o estudo dos modelos de regressão. Sua importância não se limita à simplicidade algébrica, mas repousa no fato de que ele estabelece as bases conceituais para toda a teoria de modelagem estatística. Ao assumir que a variação média de uma variável resposta <span class="math inline">\(Y\)</span> pode ser explicada por uma única variável explicativa <span class="math inline">\(X\)</span>, o MRLS introduz a noção central de <strong>média condicional</strong>, isto é, a ideia de que existe uma estrutura determinística que organiza o comportamento médio dos dados, à qual se sobrepõe uma componente aleatória que representa o ruído <em>inevitável</em> das observações empíricas.</p>
<p>Essa leitura “pela média condicional” é a forma mais precisa de entender o que a regressão linear simples afirma: para cada valor fixado de <span class="math inline">\(X\)</span>, existe uma distribuição de <span class="math inline">\(Y\)</span>, e o modelo especifica como a média dessa distribuição varia com <span class="math inline">\(X\)</span>. (ver <span class="citation" data-cites="montgomery2021">Montgomery; Peck; Vining (<a href="references.html#ref-montgomery2021" role="doc-biblioref">2021</a>)</span>; <span class="citation" data-cites="hoffmann2016">Hoffmann (<a href="references.html#ref-hoffmann2016" role="doc-biblioref">2016</a>)</span>)</p>
<p>O intercepto e a inclinação da reta de regressão apresentadas anteriormente traduzem a parte sistemática do fenômeno, enquanto o erro agrega fatores não observados, variações aleatórias ou imprecisões de medição. É nessa combinação entre regularidade e aleatoriedade que se encontra a força do modelo: a regressão linear simples oferece uma linguagem matemática capaz de quantificar associações e, ao mesmo tempo, de reconhecer que o mundo real não se comporta de maneira perfeitamente determinística.</p>
<p>Em particular, o termo “erro” não deve ser lido como “falha”: ele representa a parcela de variabilidade de <span class="math inline">\(Y\)</span> que permanece mesmo quando <span class="math inline">\(X\)</span> é conhecido e o componente médio <span class="math inline">\(E(Y\mid X)\)</span> foi especificado. (ver <span class="citation" data-cites="kutner2005">Kutner et al. (<a href="references.html#ref-kutner2005" role="doc-biblioref">2005</a>)</span>)</p>
<p>O MRLS pode ser usado em diferentes perspectivas. Em um primeiro plano, ele ajuda a compreender como uma variável se relaciona com outra, permitindo isolar a contribuição média de <span class="math inline">\(X\)</span> sobre <span class="math inline">\(Y\)</span>. Em seguida, oferece meios de previsão, já que a reta ajustada pode ser utilizada para estimar valores futuros ou não observados de <span class="math inline">\(Y\)</span>. Finalmente, ele fornece um instrumento de controle, pois ao quantificar a variação esperada em <span class="math inline">\(Y\)</span> para uma mudança em <span class="math inline">\(X\)</span>, torna-se possível avaliar de forma objetiva a influência de um fator específico mantendo os demais aspectos fixos ou controlados no desenho do estudo. Essa tríade, nomeadamente; explicação, predição e controle, sustenta a relevância prática do modelo e justifica sua centralidade tanto no ensino quanto na aplicação da estatística.</p>
<p>Um cuidado conceitual importante é distinguir “prever o valor médio” de “prever uma observação individual”: mesmo que a média condicional seja bem descrita, observações individuais ainda variam ao redor dessa média por causa do erro aleatório. (ver <span class="citation" data-cites="montgomery2021">Montgomery; Peck; Vining (<a href="references.html#ref-montgomery2021" role="doc-biblioref">2021</a>)</span>)</p>
<p>A intuição do MRLS pode ser visualizada em gráficos de dispersão: os pontos <span class="math inline">\((X,Y)\)</span> representam as observações empíricas e, sobre esse conjunto, a reta de regressão traduz a tendência média. As distâncias verticais entre cada ponto e a reta correspondem aos resíduos, isto é, às variações não capturadas pelo modelo. Adicionalmente, sabendo que a relação entre <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> pode assumir diferentes intensidades e direções, mesmo dentro de um modelo linear simples, considere os quatro cenários a seguir, todos baseados em uma reta verdadeira perturbada por erros aleatórios:</p>
<ul>
<li><strong>(a) Correlação positiva forte</strong>: a inclinação da reta é positiva e os pontos se distribuem próximos a ela. O sinal determinístico domina, e o ruído é pequeno em relação à estrutura média.<br>
</li>
<li><strong>(b) Correlação positiva fraca</strong>: a reta mantém inclinação positiva, mas a dispersão em torno dela é elevada. O sinal ainda existe, mas é encoberto por grande variabilidade aleatória.<br>
</li>
<li><strong>(c) Correlação negativa forte</strong>: a inclinação é negativa e os pontos se alinham de forma clara em torno da reta decrescente. A média condicional é bem definida e o erro exerce papel secundário.<br>
</li>
<li><strong>(d) Correlação negativa fraca</strong>: a inclinação é negativa, porém os pontos apresentam grande dispersão em torno da reta. A variabilidade do erro é tão relevante quanto a estrutura determinística, tornando a associação menos evidente.</li>
</ul>
<p>Essas quatro situações destacam a essência do <strong>MRLS</strong>: independentemente da direção ou da força da associação, o modelo parte da ideia de que a média condicional de <span class="math inline">\(Y\)</span> pode ser descrita por uma função linear em <span class="math inline">\(X\)</span>, à qual se soma um ruído <span class="math inline">\(\varepsilon_i\)</span> com <span class="math inline">\(E[\varepsilon_i \mid X_i]=0\)</span>.</p>
<p>Vale enfatizar por que essa condição é conceitualmente importante: ela expressa que, uma vez fixado <span class="math inline">\(X_i\)</span>, o termo de erro não tem <em>tendência sistemática</em> (em média, não empurra <span class="math inline">\(Y\)</span> para cima nem para baixo), de modo que toda a variação média de <span class="math inline">\(Y\)</span> com <span class="math inline">\(X\)</span> fica concentrada no termo <span class="math inline">\(E(Y\mid X)\)</span>. Quando essa condição falha, o que se interpreta como “efeito de <span class="math inline">\(X\)</span>” pode estar contaminado por fatores omitidos que variam com <span class="math inline">\(X\)</span> (situação que, em econometria, está relacionada à ideia de endogeneidade). O gráfico, portanto, antecipa de forma intuitiva a formulação matemática que será detalhada na próxima seção.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mrls_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>Quatro cenários de associação linear: (a) positiva forte, (b) positiva fraca, (c) negativa forte, (d) negativa fraca.</figcaption>
</figure>
</div>
</div>
</div>
<p>Essa representação gráfica simples, mas poderosa, revela a lógica do modelo: a regressão não busca explicar cada observação em particular, mas descrever o comportamento médio de <span class="math inline">\(Y\)</span> em função de <span class="math inline">\(X\)</span>. É nesse sentido que ela constitui uma primeira aproximação, um alicerce sobre o qual se constroem modelos mais complexos. (ver <span class="citation" data-cites="montgomery2021">Montgomery; Peck; Vining (<a href="references.html#ref-montgomery2021" role="doc-biblioref">2021</a>)</span>)</p>
<section id="formulação-matemática-do-mrls" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="formulação-matemática-do-mrls"><span class="header-section-number">4.1</span> Formulação Matemática do MRLS</h2>
<p>A formulação do modelo de regressão linear simples parte da ideia de que cada observação <span class="math inline">\(Y_i\)</span> pode ser decomposta em duas partes: uma componente sistemática, que expressa o valor médio de <span class="math inline">\(Y\)</span> condicionado a um dado valor de <span class="math inline">\(X_i\)</span>, e uma componente aleatória, que traduz as variações não explicadas. Em notação formal, escrevemos</p>
<p><span class="math display">\[
Y_i = \mu_i + \varepsilon_i, \quad \text{com} \quad \mu_i = E[Y_i \mid X_i],
\]</span> em que <span class="math inline">\(\mu_i\)</span> é a média condicional de <span class="math inline">\(Y\)</span> dado <span class="math inline">\(X_i\)</span>, e <span class="math inline">\(\varepsilon_i\)</span> é o erro aleatório associado à observação <span class="math inline">\(i\)</span>.</p>
<p>Para que essa decomposição tenha interpretação estatística clara, é conveniente explicitar as <strong>suposições</strong> (ou hipóteses) que conectam o termo aleatório à componente sistemática. A hipótese central é que o erro, em média, não carrega informação adicional além de <span class="math inline">\(X_i\)</span>, de modo que</p>
<p><span class="math display">\[
E[\varepsilon_i \mid X_i] = 0.
\]</span> Essa condição de exogeneidade fraca garante que a parte sistemática do modelo seja, de fato, uma descrição da média condicional, e não uma mistura entre efeito sistemático e ruído (ver <span class="citation" data-cites="gujarati2006">Gujarati (<a href="references.html#ref-gujarati2006" role="doc-biblioref">2006</a>)</span>). Um modo equivalente (e útil) de ler essa hipótese é: ao fixar <span class="math inline">\(X_i\)</span>, a média de <span class="math inline">\(Y_i\)</span> é exatamente <span class="math inline">\(\mu_i\)</span>, pois</p>
<p><span class="math display">\[
E(Y_i\mid X_i)=E(\mu_i+\varepsilon_i\mid X_i)=\mu_i+E(\varepsilon_i\mid X_i)=\mu_i.
\]</span> Além da condição de média nula, frequentemente se acrescenta uma hipótese sobre a dispersão do erro, que relaciona o modelo à variância condicional de <span class="math inline">\(Y\)</span>:</p>
<p><span class="math display">\[
Var(\varepsilon_i\mid X_i)=\sigma^2.
\]</span> Por fim, para que as observações tragam informação “nova” umas em relação às outras e para que os resultados usuais de estimação e inferência sejam válidos, costuma-se assumir ausência de dependência linear entre erros de unidades distintas. Uma forma padrão de expressar isso é impor <strong>covariância nula</strong> entre erros diferentes:</p>
<p><span class="math display">\[
Cov(\varepsilon_i,\varepsilon_j\mid X_i,X_j)=0,\quad \forall i\neq j,
\]</span></p>
<p>isto é, condicionando ao conjunto de regressores, os termos de erro não apresentam associação linear entre observações distintas. Em muitos textos, essa hipótese aparece na forma mais forte de independência entre os erros; a condição de covariância nula é a expressão mínima necessária para várias propriedades algébricas clássicas do modelo linear. (ver <span class="citation" data-cites="kutner2005">Kutner et al. (<a href="references.html#ref-kutner2005" role="doc-biblioref">2005</a>)</span>; <span class="citation" data-cites="montgomery2021">Montgomery; Peck; Vining (<a href="references.html#ref-montgomery2021" role="doc-biblioref">2021</a>)</span>)</p>
<p>Sob essas suposições, podemos derivar <strong>propriedades imediatas</strong> do modelo:</p>
<ol type="1">
<li><strong>Média condicional</strong></li>
</ol>
<p><span class="math display">\[
E(Y_i\mid X_i)=E(\beta_0+\beta_1X_i+\varepsilon_i \mid X_i)=\beta_0+\beta_1X_i.
\]</span></p>
<ol start="2" type="1">
<li><strong>Variância condicional</strong></li>
</ol>
<p><span class="math display">\[
Var(Y_i\mid X_i)=E\left\{\left[Y_i-E(Y_i\mid X_i)\right]^2\mid X_i\right\}=E(\varepsilon_i^2\mid X_i)=Var(\varepsilon_i\mid X_i)=\sigma^2.
\]</span></p>
<ol start="3" type="1">
<li><strong>Covariância condicional entre observações distintas</strong></li>
</ol>
<p>Para <span class="math inline">\(i\neq j\)</span>, e condicionando ao conjunto de regressores), temos</p>
<p><span class="math display">\[
Cov(Y_i,Y_j\mid X_i,X_j)=Cov(\beta_0+\beta_1X_i+\varepsilon_i,\ \beta_0+\beta_1X_j+\varepsilon_j\mid X_i,X_j)=Cov(\varepsilon_i,\varepsilon_j\mid X_i,X_j).
\]</span></p>
<p>Assim, sob a hipótese <span class="math inline">\(Cov(\varepsilon_i,\varepsilon_j\mid X_i,X_j)=0\)</span> para <span class="math inline">\(i\neq j\)</span>, segue que</p>
<p><span class="math display">\[
Cov(Y_i,Y_j\mid X_i,X_j)=0,\quad i\neq j.
\]</span></p>
<p>A função de regressão do modelo é, portanto, a própria média condicional (ou média do componente sistemático):</p>
<p><span class="math display">\[
\mu(X_i;\beta_0,\beta_1)=E(Y_i\mid X_i)=\beta_0+\beta_1X_i.
\]</span></p>
<p>No caso linear, supõe-se que a média condicional é uma função linear nos parâmetros, de forma que</p>
<p><span class="math display">\[
E[Y_i \mid X_i] = \mu(X_i;\beta_0,\beta_1) = \beta_0 + \beta_1 X_i,
\]</span></p>
<p>o que leva à formulação completa do modelo:</p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 X_i + \varepsilon_i, \quad i=1,2,\dots,n.
\]</span> Uma vez especificada a função <span class="math inline">\(\mu(X_i;\beta_0,\beta_1)\)</span> e as hipóteses sobre <span class="math inline">\(\varepsilon_i\)</span>, a tarefa estatística passa a ser <strong>estimar</strong> <span class="math inline">\(E(Y_i\mid X_i)\)</span> (isto é, a função de regressão) a partir dos dados, tipicamente via métodos como mínimos quadrados (MMQ) e, quando apropriado, máxima verossimilhança (MMV). (ver <span class="citation" data-cites="kutner2005">Kutner et al. (<a href="references.html#ref-kutner2005" role="doc-biblioref">2005</a>)</span>; <span class="citation" data-cites="montgomery2021">Montgomery; Peck; Vining (<a href="references.html#ref-montgomery2021" role="doc-biblioref">2021</a>)</span>)</p>
</section>
<section id="interpretação-dos-parâmetros-e-hipóteses-do-modelo" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="interpretação-dos-parâmetros-e-hipóteses-do-modelo"><span class="header-section-number">4.2</span> Interpretação dos Parâmetros e Hipóteses do Modelo</h2>
<p>Nessa estrutura,</p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 X_i + \varepsilon_i,
\]</span></p>
<p><span class="math inline">\(\beta_0\)</span> representa o valor esperado de <span class="math inline">\(Y\)</span> quando <span class="math inline">\(X=0\)</span>, isto é,</p>
<p><span class="math display">\[
E(Y\mid X=0)=\beta_0,
\]</span></p>
<p>enquanto <span class="math inline">\(\beta_1\)</span> indica a taxa média de variação de <span class="math inline">\(Y\)</span> a cada incremento unitário em <span class="math inline">\(X\)</span>:</p>
<p><span class="math display">\[
E(Y\mid X=x+1)-E(Y\mid X=x)=\beta_1.
\]</span></p>
<p>Assim, <span class="math inline">\(\beta_1\)</span> mede o efeito médio de uma variação unitária em <span class="math inline">\(X\)</span> sobre a média condicional de <span class="math inline">\(Y\)</span>. O erro <span class="math inline">\(\varepsilon_i\)</span> traduz tanto a variabilidade natural dos fenômenos quanto fatores não observados, assumindo sempre que sua esperança condicional a <span class="math inline">\(X_i\)</span> seja nula.</p>
<p>É essencial notar que “<span class="math inline">\(X=0\)</span>” pode não ter significado em alguns contextos; ainda assim, <span class="math inline">\(\beta_0\)</span> permanece necessário como parâmetro de localização da reta. Quando <span class="math inline">\(0\)</span> não pertence ao intervalo observado de <span class="math inline">\(X\)</span>, ou quando não possui interpretação prática, pode-se redefinir a variável explicativa por centralização (por exemplo, <span class="math inline">\(X_i^\ast = X_i - \bar X\)</span>), de modo que o novo intercepto represente o valor esperado de <span class="math inline">\(Y\)</span> em um ponto de referência mais informativo. (ver <span class="citation" data-cites="montgomery2021">Montgomery; Peck; Vining (<a href="references.html#ref-montgomery2021" role="doc-biblioref">2021</a>)</span>)</p>
</section>
<section id="hipóteses-do-mrls" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="hipóteses-do-mrls"><span class="header-section-number">4.3</span> Hipóteses do MRLS</h2>
<p>Para que o modelo tenha propriedades estatísticas bem definidas, é conveniente explicitar as <strong>hipóteses clássicas do MRLS</strong>, usualmente apresentadas na literatura de modelos lineares (ver <span class="citation" data-cites="kutner2005">Kutner et al. (<a href="references.html#ref-kutner2005" role="doc-biblioref">2005</a>)</span>). Sob a formulação clássica, assumimos:</p>
<ol type="1">
<li><strong>Linearidade nos parâmetros</strong></li>
</ol>
<p>A função de regressão é linear nos parâmetros:</p>
<p><span class="math display">\[
E(Y_i\mid X_i)=\beta_0+\beta_1X_i.
\]</span></p>
<p>Observe que a linearidade refere-se aos parâmetros <span class="math inline">\(\beta_0,\beta_1\)</span>, e não necessariamente à variável <span class="math inline">\(X\)</span> em si.</p>
<ol start="2" type="1">
<li><strong>Valores de <span class="math inline">\(X\)</span> fixos (ou condicionais)</strong></li>
</ol>
<p>Os valores <span class="math inline">\(X_i\)</span> são considerados fixos pelo planejamento do estudo, ou, alternativamente, a análise é conduzida condicionalmente aos valores observados de <span class="math inline">\(X\)</span>. Essa hipótese garante que toda a aleatoriedade do modelo esteja concentrada no termo de erro.</p>
<ol start="3" type="1">
<li><strong>Erro com média zero</strong></li>
</ol>
<p><span class="math display">\[
E(\varepsilon_i\mid X_i)=0.
\]</span></p>
<p>Essa condição assegura que o componente sistemático do modelo coincide com a média condicional de <span class="math inline">\(Y\)</span>.</p>
<ol start="4" type="1">
<li><strong>Homoscedasticidade</strong></li>
</ol>
<p>A variância do erro é constante para todos os valores de <span class="math inline">\(X\)</span>:</p>
<p><span class="math display">\[
Var(\varepsilon_i\mid X_i)=\sigma^2.
\]</span></p>
<p>Consequentemente,</p>
<p><span class="math display">\[
Var(Y_i\mid X_i)=\sigma^2.
\]</span></p>
<ol start="5" type="1">
<li><strong>Ausência de correlação entre erros</strong></li>
</ol>
<p>Para <span class="math inline">\(i\neq j\)</span>,</p>
<p><span class="math display">\[
Cov(\varepsilon_i,\varepsilon_j\mid X)=0.
\]</span></p>
<p>Sob essa hipótese, segue que</p>
<p><span class="math display">\[
Cov(Y_i,Y_j\mid X)=0,\quad \forall i\neq j.
\]</span></p>
<p>Essas cinco condições compõem o conjunto clássico de hipóteses do modelo linear simples conforme apresentado em textos de modelos lineares aplicados (ver <span class="citation" data-cites="kutner2005">Kutner et al. (<a href="references.html#ref-kutner2005" role="doc-biblioref">2005</a>)</span>).</p>
<section id="hipóteses-adicionais-para-inferência" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="hipóteses-adicionais-para-inferência"><span class="header-section-number">4.3.1</span> Hipóteses adicionais para inferência</h3>
<p>Até este ponto, não foi necessário supor nenhuma distribuição específica para os erros. As hipóteses acima são suficientes para garantir propriedades como não-viesamento dos estimadores de mínimos quadrados e expressões fechadas para suas variâncias.</p>
<p>Para a construção de intervalos de confiança exatos e testes de hipóteses com distribuição conhecida em amostras finitas, acrescenta-se frequentemente a suposição de <strong>normalidade dos erros</strong>:</p>
<p><span class="math display">\[
\varepsilon_i \sim N(0,\sigma^2).
\]</span></p>
<p>Sob essa condição, o vetor de respostas possui distribuição normal multivariada condicional a <span class="math inline">\(X\)</span>, o que permite derivar resultados exatos para estatísticas <span class="math inline">\(t\)</span> e <span class="math inline">\(F\)</span>.</p>
<p>É conceitualmente importante distinguir:</p>
<ul>
<li><strong>Hipóteses do modelo básico</strong>: linearidade em <span class="math inline">\(\beta_0,\beta_1\)</span> e <span class="math inline">\(E(\varepsilon\mid X)=0\)</span>;</li>
<li><strong>Hipóteses para eficiência e inferência exata</strong>: homoscedasticidade, ausência de correlação e normalidade.</li>
</ul>
<p>Essa distinção é enfatizada na literatura de regressão aplicada, que separa claramente a estrutura do modelo da estrutura probabilística necessária para inferência (ver <span class="citation" data-cites="weisberg2005">Weisberg (<a href="references.html#ref-weisberg2005" role="doc-biblioref">2005</a>)</span>).</p>
<p>Por fim, essa formulação pode ser interpretada sob duas perspectivas equivalentes. Na abordagem clássica, <span class="math inline">\(X\)</span> é tratado como fixo. Em contextos amostrais, pode-se admitir <span class="math inline">\(X\)</span> aleatório, desde que se mantenha a condição</p>
<p><span class="math display">\[
E(\varepsilon_i\mid X_i)=0,
\]</span></p>
<p>que garante a validade das propriedades do modelo condicionalmente a <span class="math inline">\(X\)</span>. Em ambas as leituras, permanece a essência: a regressão linear simples é um modelo para a média condicional de <span class="math inline">\(Y\)</span> dado <span class="math inline">\(X\)</span>, e não para cada observação individual. (ver <span class="citation" data-cites="gujarati2006">Gujarati (<a href="references.html#ref-gujarati2006" role="doc-biblioref">2006</a>)</span>)</p>
</section>
</section>
<section id="representação-gráfica-e-intuição-geométrica" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="representação-gráfica-e-intuição-geométrica"><span class="header-section-number">4.4</span> Representação Gráfica e Intuição Geométrica</h2>
<p>A Figura a seguir ilustra o que significa afirmar que o <strong>MRLS é um modelo para a média condicional</strong>. Os pontos azuis representam as observações empíricas <span class="math inline">\((X_i,Y_i)\)</span>, que se espalham devido ao ruído aleatório <span class="math inline">\(\varepsilon_i\)</span>. A reta vermelha mostra a estrutura determinística <span class="math inline">\(\beta_0 + \beta_1 X\)</span>, isto é, o valor esperado de <span class="math inline">\(Y\)</span> para cada valor de <span class="math inline">\(X\)</span>. Já os círculos pretos conectados indicam médias locais de <span class="math inline">\(Y\)</span> em diferentes intervalos de <span class="math inline">\(X\)</span>, funcionando como uma aproximação empírica de <span class="math inline">\(E[Y \mid X]\)</span>. O alinhamento dessas médias com a reta reforça a ideia de que o modelo busca descrever a <strong>tendência média</strong> e não cada observação individual.</p>
<p>Este gráfico torna visível a condição fundamental <span class="math inline">\(E[\varepsilon_i \mid X_i]=0\)</span>. Embora cada ponto esteja sujeito a variações não explicadas, quando olhamos para a média em cada faixa de <span class="math inline">\(X\)</span>, os erros se compensam e a estrutura linear emerge. Assim, é possível notar intuitivamente por que se fala em “média condicional” e compreendemos que a regressão não elimina o ruído, mas organiza o comportamento médio das observações em torno de uma reta. (ver <span class="citation" data-cites="charnet2008">Charnet et al. (<a href="references.html#ref-charnet2008" role="doc-biblioref">2008</a>)</span>)</p>
<p>Mais adiante, quando abordarmos o método dos mínimos quadrados ordinários, introduziremos outra visualização complementar, na qual os resíduos aparecem como segmentos verticais entre os pontos observados e a reta ajustada. Essas representações reforçam a interpretação fundamental: o MRLS não pretende capturar cada realização individual, mas descrever a tendência média de <span class="math inline">\(Y\)</span> em função de <span class="math inline">\(X\)</span>, admitindo explicitamente a presença de ruído.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mrls_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="840"></p>
<figcaption>MRLS como média condicional: pontos observados (X,Y), reta verdadeira (média condicional) e médias locais de Y por faixas de X.</figcaption>
</figure>
</div>
</div>
</div>


<div id="refs" class="references csl-bib-body" data-entry-spacing="1" role="list" style="display: none">
<div id="ref-charnet2008" class="csl-entry" role="listitem">
CHARNET, Reinaldo <em>et al.</em> <strong>Análise de Modelos de Regressão Linear com Aplicações</strong>. 2. ed. Campinas: EDUNICAMP, 2008.
</div>
<div id="ref-gujarati2006" class="csl-entry" role="listitem">
GUJARATI, Damodar N. <strong>Econometria Básica</strong>. 4. ed. Rio de Janeiro: Elsevier Campus, 2006.
</div>
<div id="ref-hoffmann2016" class="csl-entry" role="listitem">
HOFFMANN, Rodolfo. <strong><a href="https://doi.org/10.11606/9788592105709">Análise de Regressão: Uma Introdução à Econometria</a></strong>. 5. ed. <em>[S.l.]</em>: Portal de Livros Abertos da USP, 2016.
</div>
<div id="ref-kutner2005" class="csl-entry" role="listitem">
KUTNER, Michael H. <em>et al.</em> <strong>Applied Linear Statistical Models</strong>. 5. ed. New York: McGraw-Hill, 2005.
</div>
<div id="ref-montgomery2021" class="csl-entry" role="listitem">
MONTGOMERY, Douglas C.; PECK, Elizabeth A.; VINING, G. Geoffrey. <strong>Introduction to Linear Regression Analysis</strong>. 6. ed. Hoboken: John Wiley &amp; Sons, 2021.
</div>
<div id="ref-weisberg2005" class="csl-entry" role="listitem">
WEISBERG, Sanford. <strong>Applied Linear Regression</strong>. New York: Wiley, 2005.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiada");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiada");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./part1_ex.html" class="pagination-link" aria-label="Exercícios e Atividades de Consolidação">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exercícios e Atividades de Consolidação</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./mrls_emq.html" class="pagination-link" aria-label="Estimação por Mínimos Quadrados no MRLS">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Estimação por Mínimos Quadrados no MRLS</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>