<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt-BR" xml:lang="pt-BR"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.23">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>10&nbsp; Comparação de Modelos</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 1em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./part2_ex.html" rel="next">
<link href="./mrls_transf.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-1fe81d0376b2c50856e68e651e390326.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-70a47bd5681a7291082a5b9f83d58762.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./mrls.html">Parte II — Modelo de Regressão Linear Simples (MRLS)</a></li><li class="breadcrumb-item"><a href="./mrls_compara.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Comparação de Modelos</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Procurar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Procurar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Informações Legais e Declaração de Uso de Inteligência Artificial</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./prefacio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Prefácio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./identifica.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Identificação da Disciplina</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte I — Modelagem</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introdução e Panorama dos Modelos de Regressão</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelagem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Modelagem Estatística e Regressão</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part1_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exercícios e Atividades de Consolidação</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte II — Modelo de Regressão Linear Simples (MRLS)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mrls.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">O MRLS como Modelo para a Média Condicional</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mrls_emq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Estimação por Mínimos Quadrados no MRLS</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mrls_inferencia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Inferência no MRLS com erros normais</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mrls_testes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Testes de hipóteses e ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mrls_diagnostico.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Diagnóstico e Avaliação no MRLS</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mrls_transf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Transformações nas Variáveis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mrls_compara.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Comparação de Modelos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part2_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Exercícios e Atividades de Consolidação</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte III — Modelo de Regressão Linear Simples (MRLM)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part3_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Exercícios e Atividades de Consolidação</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Parte IV — Apêndices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Alternar seção">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ap_listas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Lista de Siglas e Símbolos</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ap_matrizes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Estrutura Matricial dos Modelos de Regressão Linear</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ap_normal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Distribuição Normal</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ap_forma_linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Formas Lineares e Quadráticas na Normal Multivariada</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ap_tratamento.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Tratamento de dados para regressão</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./part4_ex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Exercícios e Atividades de Consolidação</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referências</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Índice</h2>
   
  <ul>
  <li><a href="#motivação-e-princípios-de-comparação" id="toc-motivação-e-princípios-de-comparação" class="nav-link active" data-scroll-target="#motivação-e-princípios-de-comparação"><span class="header-section-number">10.1</span> Motivação e princípios de comparação</a>
  <ul class="collapse">
  <li><a href="#finalidade-da-comparação-explicar-ou-prever" id="toc-finalidade-da-comparação-explicar-ou-prever" class="nav-link" data-scroll-target="#finalidade-da-comparação-explicar-ou-prever"><span class="header-section-number">10.1.1</span> Finalidade da comparação: explicar ou prever</a></li>
  </ul></li>
  <li><a href="#critérios-clássicos-de-comparação" id="toc-critérios-clássicos-de-comparação" class="nav-link" data-scroll-target="#critérios-clássicos-de-comparação"><span class="header-section-number">10.2</span> Critérios clássicos de comparação</a>
  <ul class="collapse">
  <li><a href="#coeficiente-de-determinação-r2" id="toc-coeficiente-de-determinação-r2" class="nav-link" data-scroll-target="#coeficiente-de-determinação-r2"><span class="header-section-number">10.2.1</span> Coeficiente de determinação <span class="math inline">\(R^2\)</span></a></li>
  <li><a href="#coeficiente-de-determinação-ajustado-r2_aj" id="toc-coeficiente-de-determinação-ajustado-r2_aj" class="nav-link" data-scroll-target="#coeficiente-de-determinação-ajustado-r2_aj"><span class="header-section-number">10.2.2</span> Coeficiente de determinação ajustado <span class="math inline">\(R^2_{aj}\)</span></a></li>
  <li><a href="#teste-f-para-modelos-aninhados" id="toc-teste-f-para-modelos-aninhados" class="nav-link" data-scroll-target="#teste-f-para-modelos-aninhados"><span class="header-section-number">10.2.3</span> Teste <span class="math inline">\(F\)</span> para modelos aninhados</a></li>
  </ul></li>
  <li><a href="#critérios-de-informação" id="toc-critérios-de-informação" class="nav-link" data-scroll-target="#critérios-de-informação"><span class="header-section-number">10.3</span> Critérios de informação</a>
  <ul class="collapse">
  <li><a href="#critério-de-informação-de-akaike-aic" id="toc-critério-de-informação-de-akaike-aic" class="nav-link" data-scroll-target="#critério-de-informação-de-akaike-aic"><span class="header-section-number">10.3.1</span> Critério de Informação de Akaike (AIC)</a></li>
  <li><a href="#critério-bayesiano-de-schwarz-bic" id="toc-critério-bayesiano-de-schwarz-bic" class="nav-link" data-scroll-target="#critério-bayesiano-de-schwarz-bic"><span class="header-section-number">10.3.2</span> Critério Bayesiano de Schwarz (BIC)</a></li>
  <li><a href="#boas-práticas-e-comparabilidade-entre-escalas" id="toc-boas-práticas-e-comparabilidade-entre-escalas" class="nav-link" data-scroll-target="#boas-práticas-e-comparabilidade-entre-escalas"><span class="header-section-number">10.3.3</span> Boas práticas e comparabilidade entre escalas</a></li>
  <li><a href="#estratégia-prática-de-comparação" id="toc-estratégia-prática-de-comparação" class="nav-link" data-scroll-target="#estratégia-prática-de-comparação"><span class="header-section-number">10.3.4</span> Estratégia prática de comparação</a></li>
  </ul></li>
  <li><a href="#exemplos-ilustrativos-de-comparação-de-modelos" id="toc-exemplos-ilustrativos-de-comparação-de-modelos" class="nav-link" data-scroll-target="#exemplos-ilustrativos-de-comparação-de-modelos"><span class="header-section-number">10.4</span> Exemplos ilustrativos de comparação de modelos</a>
  <ul class="collapse">
  <li><a href="#exemplo-1-intercepto-e-transformação-na-resposta" id="toc-exemplo-1-intercepto-e-transformação-na-resposta" class="nav-link" data-scroll-target="#exemplo-1-intercepto-e-transformação-na-resposta"><span class="header-section-number">10.4.1</span> Exemplo 1 — Intercepto e transformação na resposta</a></li>
  <li><a href="#exemplo-2-escolhendo-a-melhor-variável-explicativa" id="toc-exemplo-2-escolhendo-a-melhor-variável-explicativa" class="nav-link" data-scroll-target="#exemplo-2-escolhendo-a-melhor-variável-explicativa"><span class="header-section-number">10.4.2</span> Exemplo 2 — Escolhendo a melhor variável explicativa</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./mrls.html">Parte II — Modelo de Regressão Linear Simples (MRLS)</a></li><li class="breadcrumb-item"><a href="./mrls_compara.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Comparação de Modelos</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Comparação de Modelos</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="motivação-e-princípios-de-comparação" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="motivação-e-princípios-de-comparação"><span class="header-section-number">10.1</span> Motivação e princípios de comparação</h2>
<p>Após discutir a análise de resíduos, surge uma questão natural: <strong>como escolher entre diferentes modelos candidatos?</strong> Nem sempre um único modelo é suficiente; muitas vezes ajustamos <strong>várias alternativas</strong> e precisamos compará-las.</p>
<p>A comparação de modelos, porém, não é um “campeonato de métricas”. Ela deve ser entendida como uma decisão estatística guiada por três ideias centrais: <strong>adequação</strong>, <strong>parcimônia</strong> e <strong>finalidade</strong> (explicar vs prever). Em particular, comparar modelos significa avaliar <strong>trocas (trade-offs)</strong>: um modelo pode ajustar melhor os dados, mas à custa de maior complexidade e menor estabilidade, especialmente em amostras moderadas/pequenas.</p>
<p>A comparação de modelos envolve duas dimensões principais:</p>
<ol type="1">
<li><strong>Qualidade estatística do ajuste</strong> – medida por critérios formais (ex.: <span class="math inline">\(R^2\)</span>, teste <span class="math inline">\(F\)</span>, AIC, BIC).<br>
</li>
<li><strong>Pertinência substantiva</strong> – se o modelo faz sentido em relação ao fenômeno estudado, é parcimonioso e interpretável.</li>
</ol>
<p>Em regressão, “modelo melhor” <strong>não significa</strong> “modelo com o maior ajuste numérico”. O ponto é: um modelo é um <strong>compromisso</strong> entre (i) representar a estrutura sistemática de <span class="math inline">\(Y\)</span> explicada por <span class="math inline">\(X\)</span> e (ii) não incorporar estrutura espúria (ruído) como se fosse sinal. Critérios como AIC e BIC foram propostos justamente para explicitar essa troca: melhorar o ajuste (via log-verossimilhança) <strong>custa</strong> complexidade (número de parâmetros), e essa penalização é uma maneira de desencorajar sobreajuste <span class="citation" data-cites="akaike1974 schwarz1978 burnham2002">(<a href="references.html#ref-akaike1974" role="doc-biblioref">Akaike, 1974</a>; <a href="references.html#ref-burnham2002" role="doc-biblioref">Burnham; Anderson, 2002</a>; <a href="references.html#ref-schwarz1978" role="doc-biblioref">Schwarz, 1978</a>)</span>.</p>
<p>Um ponto central é que <strong>não adianta comparar dois modelos se ambos têm resíduos inadequados</strong>. O primeiro filtro deve ser sempre o diagnóstico dos resíduos. Uma vez que os modelos estejam pelo menos aproximadamente bem especificados, podemos partir para critérios comparativos.</p>
<p>Essa ordem (“diagnóstico <span class="math inline">\(\rightarrow\)</span> comparação”) é importante porque muitos critérios formais assumem que o modelo está <strong>minimamente compatível</strong> com as hipóteses estruturais do MRLS (por exemplo: relação média aproximadamente linear na escala adotada, variância aproximadamente constante e ausência de padrões sistemáticos evidentes nos resíduos). Se essas condições falham, é comum observar situações enganosas como:</p>
<ul>
<li>um modelo com <span class="math inline">\(R^2\)</span> alto, mas com <strong>padrão em funil</strong> (heteroscedasticidade), o que compromete inferência usual e previsões com incerteza mal calibrada;</li>
<li>um modelo com ligeira melhora em AIC/BIC após adicionar termos, mas com <strong>curvatura residual persistente</strong>, sinalizando que a forma funcional ainda está incorreta;</li>
<li>um modelo “mais complexo” que parece melhor no ajuste dentro da amostra, mas piora a capacidade de generalização (sobreajuste).</li>
</ul>
<section id="finalidade-da-comparação-explicar-ou-prever" class="level3" data-number="10.1.1">
<h3 data-number="10.1.1" class="anchored" data-anchor-id="finalidade-da-comparação-explicar-ou-prever"><span class="header-section-number">10.1.1</span> Finalidade da comparação: explicar ou prever</h3>
<p>Antes de escolher um critério, é útil explicitar o objetivo:</p>
<ul>
<li><strong>Explicação/interpretação:</strong> prioriza parâmetros estáveis e interpretáveis e tende a valorizar parcimônia (frequentemente BIC é usado como referência em seleção mais “conservadora”).<br>
</li>
<li><strong>Predição:</strong> prioriza desempenho fora da amostra; critérios baseados em verossimilhança com penalização moderada (como AIC) são frequentemente usados como aproximações de desempenho preditivo, mas idealmente devem ser complementados por validação (ex.: validação cruzada) quando isso fizer parte do desenho analítico <span class="citation" data-cites="burnham2002">(<a href="references.html#ref-burnham2002" role="doc-biblioref">Burnham; Anderson, 2002</a>)</span>.</li>
</ul>
<p>Nesta seção, organizamos os principais critérios formais e práticos de comparação, seguidos de exemplos ilustrativos.</p>
</section>
</section>
<section id="critérios-clássicos-de-comparação" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="critérios-clássicos-de-comparação"><span class="header-section-number">10.2</span> Critérios clássicos de comparação</h2>
<section id="coeficiente-de-determinação-r2" class="level3" data-number="10.2.1">
<h3 data-number="10.2.1" class="anchored" data-anchor-id="coeficiente-de-determinação-r2"><span class="header-section-number">10.2.1</span> Coeficiente de determinação <span class="math inline">\(R^2\)</span></h3>
<p>O <span class="math inline">\(R^2\)</span> mede a proporção da variabilidade de <span class="math inline">\(Y\)</span> explicada pelo modelo:</p>
<p><span class="math display">\[
R^2 = 1 - \frac{SQ_{Res}}{SQ_{Tot}},
\]</span></p>
<p>em que <span class="math inline">\(SQ_{Res} = \sum_{i=1}^n (Y_i-\hat Y_i)^2\)</span> é a soma de quadrados dos resíduos e <span class="math inline">\(SQ_{Tot} = \sum_{i=1}^n (Y_i-\bar Y)^2\)</span> é a soma de quadrados total.</p>
<p>O <span class="math inline">\(R^2\)</span> responde à pergunta: “<strong>quanto da variabilidade total observada em</strong> <span class="math inline">\(Y\)</span> foi capturada pelo componente sistemático do modelo?”. Ele é, portanto, uma medida <strong>descritiva de ajuste</strong>: compara o erro do modelo com o erro de um “modelo nulo” que sempre prediz <span class="math inline">\(\bar Y\)</span>.</p>
<p>Como a decomposição <span class="math display">\[
SQ_{Tot}=SQ_{Reg}+SQ_{Res}
\]</span> vale no MRLS com intercepto, também podemos escrever <span class="math display">\[
R^2=\frac{SQ_{Reg}}{SQ_{Tot}},
\]</span> isto é, a fração da variabilidade total explicada pela regressão.</p>
<section id="propriedades-e-limitações" class="level4" data-number="10.2.1.1">
<h4 data-number="10.2.1.1" class="anchored" data-anchor-id="propriedades-e-limitações"><span class="header-section-number">10.2.1.1</span> Propriedades e limitações</h4>
<p>É tentador ler <span class="math inline">\(R^2\)</span> como “o modelo é bom/ruim”, mas isso é perigoso por três razões:</p>
<ol type="1">
<li><span class="math inline">\(R^2\)</span> não diagnostica adequação das hipóteses: um modelo pode ter <span class="math inline">\(R^2\)</span> alto e ainda assim apresentar resíduos com curvatura, heteroscedasticidade ou dependência. Por isso, o diagnóstico de resíduos vem antes.</li>
<li><span class="math inline">\(R^2\)</span> não mede capacidade preditiva fora da amostra: ele é calculado na amostra usada no ajuste.</li>
<li><span class="math inline">\(R^2\)</span> depende da variabilidade de <span class="math inline">\(Y\)</span>: em bases com pouca variação em <span class="math inline">\(Y\)</span>, mesmo modelos úteis podem ter <span class="math inline">\(R^2\)</span> modestos; e em bases com grande variação em <span class="math inline">\(Y\)</span>, <span class="math inline">\(R^2\)</span> pode ser alto sem que o modelo seja substantivamente satisfatório.</li>
</ol>
<p><strong>Vantagens e limitaçoes</strong></p>
<ul>
<li><strong>Vantagem:</strong> fornece uma medida intuitiva de ajuste.<br>
</li>
<li><strong>Limitação 1 (monotonicidade):</strong> em modelos de MQO com intercepto, <span class="math inline">\(R^2\)</span> <strong>nunca diminui</strong> quando adicionamos regressores ao conjunto de candidatos. Isso ocorre porque, ao adicionar parâmetros, o MQO minimiza <span class="math inline">\(SQ_{Res}\)</span> em um espaço maior, logo <span class="math inline">\(SQ_{Res}\)</span> só pode diminuir (ou permanecer igual).<br>
</li>
<li><strong>Limitação 2 (comparabilidade):</strong> <span class="math inline">\(R^2\)</span> <strong>não é comparável</strong> entre modelos com e sem intercepto, pois a decomposição de somas de quadrados muda. Em particular, quando o intercepto é omitido, o “modelo nulo” implícito deixa de ser <span class="math inline">\(Y=\bar Y\)</span>, e interpretações usuais de <span class="math inline">\(R^2\)</span> podem se tornar enganosas.</li>
<li><strong>Limitação 3 (escala da resposta):</strong> se você transforma <span class="math inline">\(Y\)</span> (por exemplo, <span class="math inline">\(\log(Y)\)</span>), o <span class="math inline">\(R^2\)</span> passa a descrever ajuste <strong>na escala transformada</strong>, não na escala original.</li>
</ul>
<blockquote class="blockquote">
<p><strong>Observação:</strong> no MRLS (com intercepto), vale a relação <span class="math inline">\(R^2=r_{XY}^2\)</span>, conectando a medida de ajuste com a intensidade de associação linear entre <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>.</p>
</blockquote>
</section>
</section>
<section id="coeficiente-de-determinação-ajustado-r2_aj" class="level3" data-number="10.2.2">
<h3 data-number="10.2.2" class="anchored" data-anchor-id="coeficiente-de-determinação-ajustado-r2_aj"><span class="header-section-number">10.2.2</span> Coeficiente de determinação ajustado <span class="math inline">\(R^2_{aj}\)</span></h3>
<p>Para penalizar modelos excessivamente complexos, define-se:</p>
<p><span class="math display">\[
R^2_{aj} = 1 - \frac{SQ_{Res}/(n-p)}{SQ_{Tot}/(n-1)},
\]</span></p>
<p>em que <span class="math inline">\(n\)</span> é o tamanho da amostra e <span class="math inline">\(p\)</span> é o número de parâmetros (incluindo o intercepto).</p>
<p>O <span class="math inline">\(R^2_{aj}\)</span> substitui “proporção de variância explicada” por uma comparação entre <strong>variâncias estimadas</strong>:</p>
<ul>
<li><span class="math inline">\(SQ_{Res}/(n-p)\)</span> é o estimador de <span class="math inline">\(\sigma^2\)</span> (variância do erro) sob o modelo candidato;</li>
<li><span class="math inline">\(SQ_{Tot}/(n-1)\)</span> é a variância amostral de <span class="math inline">\(Y\)</span>.</li>
</ul>
<p>Assim, <span class="math inline">\(R^2_{aj}\)</span> pergunta: “<strong>o quanto a variância residual estimada caiu em relação à variância total de</strong> <span class="math inline">\(Y\)</span>, levando em conta quantos parâmetros eu usei para isso?”.</p>
<p>Ao contrário do <span class="math inline">\(R^2\)</span>, o <span class="math inline">\(R^2_{aj}\)</span> <strong>pode diminuir</strong> quando adicionamos regressoras. Isso é desejável: se um novo termo reduz pouco o <span class="math inline">\(SQ_{Res}\)</span>, a penalização por perder graus de liberdade pode dominar, sinalizando que o ganho de ajuste não compensa a complexidade.</p>
<section id="vantagens-e-limitações" class="level4" data-number="10.2.2.1">
<h4 data-number="10.2.2.1" class="anchored" data-anchor-id="vantagens-e-limitações"><span class="header-section-number">10.2.2.1</span> Vantagens e limitações</h4>
<ul>
<li><strong>Vantagem:</strong> permite comparar modelos com diferentes números de parâmetros, desde que estejam na mesma escala da resposta e com intercepto.<br>
</li>
<li><strong>Limitação:</strong> em amostras pequenas, ainda pode favorecer modelos com leve sobreajuste, pois sua penalização é relativamente moderada.<br>
</li>
<li><strong>Uso prático:</strong> quando a comparação envolve modelos com diferentes estruturas, <span class="math inline">\(R^2_{aj}\)</span> é preferível ao <span class="math inline">\(R^2\)</span> simples.</li>
</ul>
</section>
</section>
<section id="teste-f-para-modelos-aninhados" class="level3" data-number="10.2.3">
<h3 data-number="10.2.3" class="anchored" data-anchor-id="teste-f-para-modelos-aninhados"><span class="header-section-number">10.2.3</span> Teste <span class="math inline">\(F\)</span> para modelos aninhados</h3>
<p>Quando um modelo é <strong>caso particular de outro</strong> (modelo restrito vs.&nbsp;modelo completo), podemos usar:</p>
<p><span class="math display">\[
F = \frac{(SQ_{Res,\,restrito} - SQ_{Res,\,completo})/q}{SQ_{Res,\,completo}/(n-p)},
\]</span></p>
<p>em que:</p>
<ul>
<li><span class="math inline">\(q\)</span> é o número de restrições impostas (equivalentemente, o número de parâmetros “removidos” quando passamos do completo para o restrito);</li>
<li><span class="math inline">\(p\)</span> é o número de parâmetros no modelo completo (incluindo intercepto).</li>
</ul>
<p>O teste <span class="math inline">\(F\)</span> para modelos aninhados avalia se a redução em <span class="math inline">\(SQ_{Res}\)</span> ao passarmos do modelo restrito para o completo é <strong>grande o suficiente</strong> para justificar os parâmetros adicionais.</p>
<ul>
<li>No numerador está o “ganho médio” de ajuste por restrição relaxada: <span class="math inline">\((SQ_{Res,restrito}-SQ_{Res,completo})/q\)</span>.</li>
<li>No denominador está uma estimativa de <span class="math inline">\(\sigma^2\)</span> no modelo completo: <span class="math inline">\(SQ_{Res,completo}/(n-p)\)</span>.</li>
</ul>
<p>Se o ganho médio (numerador) é grande comparado ao ruído residual esperado (denominador), a estatística <span class="math inline">\(F\)</span> fica grande e rejeitamos o modelo restrito.</p>
<section id="hipóteses-e-decisão" class="level4" data-number="10.2.3.1">
<h4 data-number="10.2.3.1" class="anchored" data-anchor-id="hipóteses-e-decisão"><span class="header-section-number">10.2.3.1</span> Hipóteses e decisão</h4>
<ul>
<li><strong>Hipóteses:</strong>
<ul>
<li><span class="math inline">\(H_0\)</span>: as restrições são válidas (o modelo mais simples é suficiente).<br>
</li>
<li><span class="math inline">\(H_1\)</span>: pelo menos uma restrição é falsa (o modelo completo melhora o ajuste de forma relevante).</li>
</ul></li>
<li><strong>Regra:</strong> rejeitar <span class="math inline">\(H_0\)</span> para valores grandes de <span class="math inline">\(F\)</span> (ou valor-p pequeno).</li>
<li><strong>Uso:</strong> útil para verificar se a inclusão de um termo (ou intercepto) melhora de forma estatisticamente significativa o ajuste.<br>
</li>
<li><strong>Limitação:</strong> só se aplica a modelos <strong>aninhados</strong> (isto é, quando o modelo restrito pode ser obtido impondo restrições lineares nos parâmetros do modelo completo).</li>
</ul>
<p>Adicionalmente, mesmo quando o teste <span class="math inline">\(F\)</span> rejeita <span class="math inline">\(H_0\)</span>, ainda é necessário verificar:</p>
<ul>
<li>se o termo adicional tem interpretação substantiva coerente;</li>
<li>se a inclusão introduz instabilidade (por exemplo, poucos dados sustentando um termo);</li>
<li>se o ganho é relevante na prática (e não apenas detectável por tamanho amostral).</li>
</ul>
</section>
</section>
</section>
<section id="critérios-de-informação" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="critérios-de-informação"><span class="header-section-number">10.3</span> Critérios de informação</h2>
<p>Além dos critérios clássicos, que se baseiam em soma de quadrados e variâncias, temos medidas que incorporam explicitamente a ideia de <strong>verossimilhança e parcimônia</strong>. Esses critérios nascem de uma perspectiva mais geral de modelagem estatística, na qual o modelo é visto como uma aproximação para a distribuição geradora dos dados.</p>
<p>No contexto do MRLS com erros normais,</p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 X_i + \varepsilon_i,
\quad \varepsilon_i \sim \mathcal{N}(0,\sigma^2),
\]</span></p>
<p>a estimação por MQO coincide com a estimação por <strong>máxima verossimilhança</strong>. Assim, podemos usar a log-verossimilhança avaliada nos estimadores para comparar modelos.</p>
<section id="critério-de-informação-de-akaike-aic" class="level3" data-number="10.3.1">
<h3 data-number="10.3.1" class="anchored" data-anchor-id="critério-de-informação-de-akaike-aic"><span class="header-section-number">10.3.1</span> Critério de Informação de Akaike (AIC)</h3>
<p><span class="math display">\[
AIC = -2\ell(\hat\theta) + 2p,
\]</span></p>
<p>em que:</p>
<ul>
<li><span class="math inline">\(\ell(\hat\theta)\)</span> é a log-verossimilhança no ponto estimado;</li>
<li><span class="math inline">\(p\)</span> é o número de parâmetros estimados (incluindo <span class="math inline">\(\sigma^2\)</span>, quando apropriado).</li>
</ul>
<p>O AIC pode ser interpretado como uma aproximação para a <strong>distância de Kullback–Leibler</strong> entre o modelo candidato e o verdadeiro mecanismo gerador dos dados (<span class="citation" data-cites="akaike1974">Akaike (<a href="references.html#ref-akaike1974" role="doc-biblioref">1974</a>)</span>; <span class="citation" data-cites="burnham2002">Burnham; Anderson (<a href="references.html#ref-burnham2002" role="doc-biblioref">2002</a>)</span>). Ele busca selecionar o modelo que, entre os candidatos, minimiza a perda de informação esperada.</p>
<p>A estrutura do critério explicita o compromisso:</p>
<ul>
<li><span class="math inline">\(-2\ell(\hat\theta)\)</span> recompensa melhor ajuste (maior verossimilhança);</li>
<li><span class="math inline">\(2p\)</span> penaliza complexidade.</li>
</ul>
<p>Assim, modelos com mais parâmetros precisam “ganhar” log-verossimilhança suficiente para compensar a penalização.</p>
<p><strong>Interpretação prática</strong></p>
<ul>
<li><strong>Regra:</strong> entre modelos comparáveis, preferir o de <strong>menor AIC</strong>.</li>
<li>O AIC não tem interpretação absoluta; só faz sentido <strong>comparativamente</strong>.</li>
<li>Diferenças pequenas (por exemplo, menores que 2 unidades) geralmente indicam que os modelos têm suporte semelhante nos dados (<span class="citation" data-cites="burnham2002">Burnham; Anderson (<a href="references.html#ref-burnham2002" role="doc-biblioref">2002</a>)</span>).</li>
</ul>
<p>O AIC não testa hipóteses do tipo <span class="math inline">\(H_0\)</span> vs.&nbsp;<span class="math inline">\(H_1\)</span>. Ele não produz valor-p nem decisão “rejeita/não rejeita”. É um critério de <strong>seleção por informação</strong>, não um teste clássico de significância.</p>
<p>Além disso, o AIC tende a favorecer modelos levemente mais complexos, especialmente em amostras pequenas. Em contextos de amostras reduzidas, versões corrigidas (como AICc) podem ser mais adequadas (ver <span class="citation" data-cites="burnham2002">Burnham; Anderson (<a href="references.html#ref-burnham2002" role="doc-biblioref">2002</a>)</span>).</p>
</section>
<section id="critério-bayesiano-de-schwarz-bic" class="level3" data-number="10.3.2">
<h3 data-number="10.3.2" class="anchored" data-anchor-id="critério-bayesiano-de-schwarz-bic"><span class="header-section-number">10.3.2</span> Critério Bayesiano de Schwarz (BIC)</h3>
<p><span class="math display">\[
BIC = -2\ell(\hat\theta) + p \log(n).
\]</span></p>
<p>O BIC possui forma semelhante ao AIC, mas a penalização cresce com <span class="math inline">\(\log(n)\)</span>. Assim:</p>
<ul>
<li>Para amostras grandes, <span class="math inline">\(\log(n)\)</span> pode ser bem maior que 2;</li>
<li>A penalização por parâmetro torna-se mais severa à medida que <span class="math inline">\(n\)</span> aumenta.</li>
</ul>
<p>O BIC pode ser interpretado como uma aproximação ao <strong>log do fator de Bayes</strong> sob certas condições assintóticas (<span class="citation" data-cites="schwarz1978">Schwarz (<a href="references.html#ref-schwarz1978" role="doc-biblioref">1978</a>)</span>). Por isso, ele é frequentemente associado a uma perspectiva de <strong>seleção do modelo “verdadeiro”</strong> dentro do conjunto candidato.</p>
<p><strong>Interpretação prática</strong></p>
<ul>
<li><strong>Regra:</strong> entre modelos comparáveis, preferir o de <strong>menor BIC</strong>.</li>
<li>O BIC tende a ser mais conservador que o AIC.</li>
<li>Em amostras grandes, pode penalizar fortemente modelos com muitos parâmetros.</li>
</ul>
</section>
<section id="boas-práticas-e-comparabilidade-entre-escalas" class="level3" data-number="10.3.3">
<h3 data-number="10.3.3" class="anchored" data-anchor-id="boas-práticas-e-comparabilidade-entre-escalas"><span class="header-section-number">10.3.3</span> Boas práticas e comparabilidade entre escalas</h3>
<p><strong>AIC vs.&nbsp;BIC: qual usar?</strong></p>
<ul>
<li><strong>AIC:</strong> mais orientado à predição e desempenho fora da amostra.<br>
</li>
<li><strong>BIC:</strong> mais orientado à identificação de uma estrutura “mais plausível” dentro do conjunto de candidatos.</li>
<li>Compare apenas modelos ajustados na <strong>mesma escala</strong> da variável resposta.</li>
</ul>
<p>A escolha depende do objetivo da análise. Em contextos aplicados, é comum reportar ambos e discutir a coerência entre eles.</p>
<blockquote class="blockquote">
<p><strong>Nota importante sobre AIC e BIC:</strong><br>
Embora possamos calcular AIC e BIC para qualquer modelo ajustado, <strong>não é correto comparar diretamente</strong> os valores de um modelo ajustado em <span class="math inline">\(Y\)</span> com outro ajustado em <span class="math inline">\(\log(Y)\)</span>, por exemplo.</p>
<p>Isso acontece porque a transformação da resposta altera a escala e a própria função de verossimilhança usada no cálculo dos critérios. Assim, os valores de AIC/BIC ficam em “bases diferentes”.</p>
<p><strong>Como proceder então?</strong><br>
- Compare AIC/BIC apenas entre modelos ajustados <strong>na mesma escala da resposta</strong>.<br>
- Use análise de resíduos e diagnóstico gráfico para avaliar se a transformação foi benéfica.<br>
- Para fins de <strong>predição</strong>, utilize métricas de erro calculadas na escala original de <span class="math inline">\(Y\)</span> (ex.: RMSE, MAE) para decidir qual modelo é mais adequado.</p>
<p>Em síntese: AIC e BIC são ferramentas valiosas, mas devem ser usados com critério. Transformações em <span class="math inline">\(Y\)</span> exigem avaliação adicional baseada em resíduos e desempenho preditivo.</p>
</blockquote>
</section>
<section id="estratégia-prática-de-comparação" class="level3" data-number="10.3.4">
<h3 data-number="10.3.4" class="anchored" data-anchor-id="estratégia-prática-de-comparação"><span class="header-section-number">10.3.4</span> Estratégia prática de comparação</h3>
<p>Ao comparar modelos alternativos:</p>
<ol type="1">
<li><strong>Primeiro passo:</strong> verifique os <strong>resíduos</strong> (condição mínima).
<ul>
<li>Se um modelo viola homocedasticidade ou apresenta estrutura sistemática, mesmo que tenha <span class="math inline">\(R^2\)</span> alto, não deve ser preferido.</li>
</ul></li>
<li><strong>Segundo passo:</strong> use os <strong>critérios formais</strong>.
<ul>
<li>Teste <span class="math inline">\(F\)</span> quando os modelos são aninhados.<br>
</li>
<li><span class="math inline">\(R^2_{aj}\)</span> quando a comparação é dentro da mesma escala.<br>
</li>
<li>AIC/BIC para comparações amplas (mesma resposta, diferentes ajustes).</li>
</ul></li>
<li><strong>Terceiro passo:</strong> considere a <strong>interpretação substantiva</strong>.
<ul>
<li>Um modelo matematicamente melhor pode ser substantivamente inadequado.</li>
</ul></li>
</ol>
</section>
</section>
<section id="exemplos-ilustrativos-de-comparação-de-modelos" class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="exemplos-ilustrativos-de-comparação-de-modelos"><span class="header-section-number">10.4</span> Exemplos ilustrativos de comparação de modelos</h2>
<p>Para consolidar as ideias, apresentamos dois exemplos didáticos que demonstram como comparar modelos no contexto do <strong>MRLS</strong>. Cada exemplo explora um tipo de decisão prática enfrentada por analistas de dados.</p>
<section id="exemplo-1-intercepto-e-transformação-na-resposta" class="level3" data-number="10.4.1">
<h3 data-number="10.4.1" class="anchored" data-anchor-id="exemplo-1-intercepto-e-transformação-na-resposta"><span class="header-section-number">10.4.1</span> Exemplo 1 — Intercepto e transformação na resposta</h3>
<p><strong>Simulação do Exemplo 1:</strong> gerar <code>df1</code> com as variáveis <code>X</code> e <code>Y</code> (com <span class="math inline">\(Y&gt;0\)</span>, para permitir <span class="math inline">\(\log(Y)\)</span>).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulação: consumo (Y) vs tempo de funcionamento (X)</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">length.out =</span> n)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Consumo com intercepto &gt; 0 (stand-by) e heterocedasticidade moderada</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="sc">+</span> <span class="fl">1.2</span><span class="sc">*</span>X</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">0.6</span> <span class="sc">+</span> <span class="fl">0.05</span><span class="sc">*</span>X</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> mu <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">pmax</span>(Y, <span class="fl">0.1</span>)  <span class="co"># garantir Y&gt;0 (para log)</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">X =</span> X, <span class="at">Y =</span> Y)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<ol type="i">
<li><strong>Cenário e modelos candidatos:</strong> consumo de energia (<span class="math inline">\(Y\)</span>) em função do tempo de funcionamento (<span class="math inline">\(X\)</span>), com <span class="math inline">\(n=50\)</span> observações.</li>
</ol>
<p><strong>Modelos candidatos:</strong></p>
<ol type="1">
<li><p>Com intercepto<br>
<span class="math display">\[
Y = \beta_0 + \beta_1 X + \varepsilon
\]</span> Representa consumo mínimo (stand-by). Esperado em contextos onde <span class="math inline">\(Y&gt;0\)</span> mesmo quando <span class="math inline">\(X=0\)</span>.</p></li>
<li><p>Sem intercepto<br>
<span class="math display">\[
Y = \beta_1 X + \varepsilon
\]</span> Força a reta a passar pela origem. Só faz sentido se sabemos que <span class="math inline">\(Y=0\)</span> quando <span class="math inline">\(X=0\)</span>.</p></li>
<li><p>Transformado (log da resposta)<br>
<span class="math display">\[
\log Y = \beta_0 + \beta_1 X + \varepsilon
\]</span></p></li>
</ol>
<p>Nesta configuração com variável transformada, o coeficiente <span class="math inline">\(\beta_1\)</span> indica a mudança <strong>aditiva em</strong> <span class="math inline">\(\log(Y)\)</span> a cada unidade adicional em <span class="math inline">\(X\)</span>. Na escala original de <span class="math inline">\(Y\)</span>, isso equivale a dizer que um aumento de 1 unidade em <span class="math inline">\(X\)</span> está associado a uma multiplicação esperada de <span class="math inline">\(Y\)</span> por <span class="math inline">\(\exp(\beta_1)\)</span>.</p>
<p>Aqui estamos comparando três “ideias de modelo” que, apesar de parecidas na forma, respondem a perguntas ligeiramente diferentes:</p>
<ul>
<li><strong>Modelo A (com intercepto)</strong> permite que exista um nível médio de consumo quando <span class="math inline">\(X=0\)</span> (consumo residual/stand-by).<br>
</li>
<li><strong>Modelo A0 (sem intercepto)</strong> declara, como hipótese estrutural, que “se <span class="math inline">\(X=0\)</span>, então <span class="math inline">\(Y=0\)</span>”. Essa é uma afirmação forte: se ela for falsa, o ajuste pode “compensar” deslocando a inclinação e gerando resíduos estruturados.<br>
</li>
<li><strong>Modelo B (com</strong> <span class="math inline">\(\log Y\)</span>) muda a escala da resposta e, portanto, muda o tipo de erro “natural” no modelo (efeitos multiplicativos no <span class="math inline">\(Y\)</span> original tendem a virar efeitos aditivos em <span class="math inline">\(\log(Y)\)</span>).</li>
</ul>
<p><strong>Visualização da primeiras linhas da Base de dados</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df1)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
      X     Y
  &lt;dbl&gt; &lt;dbl&gt;
1 0      5.37
2 0.204  5.27
3 0.408  5.97
4 0.612  6.54
5 0.816  6.22
6 1.02   6.12</code></pre>
</div>
</div>
<ol type="i">
<li><strong>Estimação e resumos dos modelos</strong></li>
</ol>
<p><strong>Ajustes e tabela de coeficientes:</strong> ajustar <code>mod_A</code>, <code>mod_A0</code> e <code>mod_log</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustes</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>mod_A   <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, <span class="at">data =</span> df1)       <span class="co"># com intercepto</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>mod_A0  <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> X, <span class="at">data =</span> df1)   <span class="co"># sem intercepto</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>mod_log <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Y) <span class="sc">~</span> X, <span class="at">data =</span> df1)  <span class="co"># resposta em log</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Modelo com intercepto (A):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Modelo com intercepto (A):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">coef</span>(<span class="fu">summary</span>(mod_A)))</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error  t value     Pr(&gt;|t|)
(Intercept) 5.137603 0.24760614 20.74909 1.297563e-25
X           1.196581 0.04266949 28.04301 2.032694e-31</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Modelo sem intercepto (A0):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Modelo sem intercepto (A0):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">coef</span>(<span class="fu">summary</span>(mod_A0)))</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Estimate Std. Error t value     Pr(&gt;|t|)
X 1.959437 0.06767437 28.9539 1.770922e-32</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Modelo com log(Y) (B):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Modelo com log(Y) (B):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">coef</span>(<span class="fu">summary</span>(mod_log)))</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Estimate  Std. Error  t value     Pr(&gt;|t|)
(Intercept) 1.7791870 0.025029186 71.08450 2.673492e-50
X           0.1143677 0.004313232 26.51554 2.548074e-30</code></pre>
</div>
</div>
<p><strong>Comentários:</strong><br>
- O <strong>Modelo A (com intercepto)</strong> mostra um termo constante significativo, representando consumo em stand-by (<span class="math inline">\(Y&gt;0\)</span> em <span class="math inline">\(x \approx 0\)</span>).<br>
- O <strong>Modelo A0 (sem intercepto)</strong> ignora o consumo em stand-by e força a reta a passar pela origem.<br>
- O <strong>Modelo B (log da resposta)</strong> reduz heteroscedasticidade: os coeficientes mantêm significância e a interpretação passa a ser na escala da variável transformada.</p>
<p><strong>Teste de resíduos (omnibus, Jarque-Bera, skew, kurtosis, Durbin-Watson, etc.)</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Testes/medidas adicionais dos resíduos</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(lmtest)   <span class="co"># dwtest</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tseries)  <span class="co"># jarque.bera.test</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(moments)  <span class="co"># skewness, kurtosis</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>res_tests <span class="ot">&lt;-</span> <span class="cf">function</span>(mod, nome){</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  e <span class="ot">&lt;-</span> <span class="fu">resid</span>(mod)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  jb <span class="ot">&lt;-</span> <span class="fu">jarque.bera.test</span>(e)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  sk <span class="ot">&lt;-</span> <span class="fu">skewness</span>(e)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  ku <span class="ot">&lt;-</span> <span class="fu">kurtosis</span>(e)  <span class="co"># kurtosis "crua" (Normal ~ 3)</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Durbin-Watson (lmtest)</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  dw <span class="ot">&lt;-</span> <span class="fu">dwtest</span>(mod)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Omnibus D'Agostino-Pearson (quando disponível via fBasics::dagoTest)</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  omni_out <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">"fBasics"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    omni_out <span class="ot">&lt;-</span> fBasics<span class="sc">::</span><span class="fu">dagoTest</span>(e)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">==============================</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Testes dos resíduos —"</span>, nome, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"==============================</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Jarque-Bera:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(jb)</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Assimetria (skewness): "</span>, <span class="fu">round</span>(sk, <span class="dv">4</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Curtose (kurtosis):   "</span>, <span class="fu">round</span>(ku, <span class="dv">4</span>), <span class="st">"  (Normal ~ 3)</span><span class="sc">\n</span><span class="st">"</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Durbin-Watson (lmtest::dwtest):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(dw)</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(omni_out)) {</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Omnibus (D'Agostino-Pearson) — fBasics::dagoTest:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(omni_out)</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Omnibus (D'Agostino-Pearson):</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Pacote 'fBasics' não disponível no ambiente. (Opcional: instalar para executar o omnibus.)</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a><span class="fu">res_tests</span>(mod_A,   <span class="st">"Modelo A (Y ~ X, com intercepto)"</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
==============================
Testes dos resíduos — Modelo A (Y ~ X, com intercepto) 
==============================
Jarque-Bera:

    Jarque Bera Test

data:  e
X-squared = 0.39891, df = 2, p-value = 0.8192


Assimetria (skewness): 0.1998
Curtose (kurtosis):   2.8216  (Normal ~ 3)

Durbin-Watson (lmtest::dwtest):

    Durbin-Watson test

data:  mod
DW = 2.165, p-value = 0.6695
alternative hypothesis: true autocorrelation is greater than 0


Omnibus (D'Agostino-Pearson) — fBasics::dagoTest:

Title:
 D'Agostino Normality Test

Test Results:
  STATISTIC:
    Chi2 | Omnibus: 0.4194
    Z3  | Skewness: 0.6388
    Z4  | Kurtosis: 0.1065
  P VALUE:
    Omnibus  Test: 0.8108 
    Skewness Test: 0.523 
    Kurtosis Test: 0.9152 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">res_tests</span>(mod_A0,  <span class="st">"Modelo A0 (Y ~ X, sem intercepto)"</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
==============================
Testes dos resíduos — Modelo A0 (Y ~ X, sem intercepto) 
==============================
Jarque-Bera:

    Jarque Bera Test

data:  e
X-squared = 2.6548, df = 2, p-value = 0.2652


Assimetria (skewness): -0.0498
Curtose (kurtosis):   1.8755  (Normal ~ 3)

Durbin-Watson (lmtest::dwtest):

    Durbin-Watson test

data:  mod
DW = 0.22013, p-value &lt; 2.2e-16
alternative hypothesis: true autocorrelation is greater than 0


Omnibus (D'Agostino-Pearson) — fBasics::dagoTest:

Title:
 D'Agostino Normality Test

Test Results:
  STATISTIC:
    Chi2 | Omnibus: 8.7587
    Z3  | Skewness: -0.1602
    Z4  | Kurtosis: -2.9552
  P VALUE:
    Omnibus  Test: 0.01253 
    Skewness Test: 0.8728 
    Kurtosis Test: 0.003125 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">res_tests</span>(mod_log, <span class="st">"Modelo B (log(Y) ~ X)"</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
==============================
Testes dos resíduos — Modelo B (log(Y) ~ X) 
==============================
Jarque-Bera:

    Jarque Bera Test

data:  e
X-squared = 3.1899, df = 2, p-value = 0.2029


Assimetria (skewness): 0.5779
Curtose (kurtosis):   3.4418  (Normal ~ 3)

Durbin-Watson (lmtest::dwtest):

    Durbin-Watson test

data:  mod
DW = 1.5831, p-value = 0.04934
alternative hypothesis: true autocorrelation is greater than 0


Omnibus (D'Agostino-Pearson) — fBasics::dagoTest:

Title:
 D'Agostino Normality Test

Test Results:
  STATISTIC:
    Chi2 | Omnibus: 4.236
    Z3  | Skewness: 1.7691
    Z4  | Kurtosis: 1.0518
  P VALUE:
    Omnibus  Test: 0.1203 
    Skewness Test: 0.07688 
    Kurtosis Test: 0.2929 </code></pre>
</div>
</div>
<p><strong>Comentários:</strong></p>
<ul>
<li><strong>Modelo A (com intercepto):</strong>
<ul>
<li>O teste Omnibus e o Jarque-Bera não são significativos (valores-p altos), sugerindo que os resíduos não violam fortemente a normalidade.<br>
</li>
<li>O Durbin-Watson próximo de 2 indica ausência de autocorrelação serial.<br>
</li>
<li>Conclusão: resíduos adequados, modelo consistente.</li>
</ul></li>
<li><strong>Modelo A0 (sem intercepto):</strong>
<ul>
<li>O Durbin-Watson é muito baixo (≈ 0,2), indicando forte autocorrelação positiva dos resíduos.<br>
</li>
<li>Embora Omnibus/Jarque-Bera não rejeitem a normalidade, a dependência serial torna o modelo problemático.<br>
</li>
<li>Conclusão: estatisticamente inadequado, reforçando que a exclusão do intercepto distorce o ajuste.</li>
</ul></li>
<li><strong>Modelo B (log da resposta):</strong>
<ul>
<li>Testes de normalidade (Omnibus, JB) continuam não significativos, mas a assimetria (Skew negativo) sugere leve desvio.<br>
</li>
<li>O Durbin-Watson ≈ 1,4 aponta alguma autocorrelação positiva.<br>
</li>
<li>Conclusão: apesar das pequenas imperfeições, o modelo log-transformado melhora a homocedasticidade em relação ao Modelo A.</li>
</ul></li>
</ul>
<p>Em dados simulados sem mecanismo temporal explícito, autocorrelação forte geralmente é um <strong>sinal de especificação inadequada</strong> (por exemplo, restrições erradas como <span class="math inline">\(\beta_0=0\)</span> podem “organizar” os resíduos e induzir padrões). Em aplicações reais, autocorrelação também pode ocorrer por dependência temporal genuína; nesse caso, o MRLS pode precisar ser estendido (tema para capítulos posteriores).</p>
<ol start="3" type="i">
<li><strong>Modelos aninhados: teste F (A0 vs A)</strong></li>
</ol>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Teste F (modelos aninhados): A0 (restrito) vs A (com intercepto)</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"ANOVA (Teste F: A0 vs A):</span><span class="sc">\n</span><span class="st">"</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>ANOVA (Teste F: A0 vs A):</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">anova</span>(mod_A0, mod_A))</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: Y ~ 0 + X
Model 2: Y ~ X
  Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
1     49 377.84                                  
2     48  37.90  1    339.94 430.52 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>O modelo sem intercepto (A0) é um <strong>caso particular</strong> do modelo com intercepto (A), obtido ao impor a restrição <span class="math inline">\(\beta_0=0\)</span>. Logo, o teste <span class="math inline">\(F\)</span> avalia se “forçar a origem” piora o ajuste além do esperado por acaso.</p>
<p><strong>Comentários:</strong><br>
- O teste F compara os modelos <strong>A0 (restrito)</strong> e <strong>A (com intercepto)</strong>.<br>
- O resultado altamente significativo (valor-p próximo de zero) indica que o <strong>intercepto é necessário</strong>.<br>
- Assim, rejeitamos o modelo sem intercepto e preferimos o modelo com intercepto.</p>
<ol start="4" type="i">
<li><strong>Comparação numérica (</strong><span class="math inline">\(R^2\)</span>, <span class="math inline">\(R_{aj}^2\)</span>, AIC, BIC)</li>
</ol>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>cmp1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Modelo =</span> <span class="fu">c</span>(<span class="st">"A: Y~X (c/ intercepto)"</span>, <span class="st">"A0: Y~X (sem intercepto)"</span>, </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>             <span class="st">"B: log(Y)~X"</span>),</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2     =</span> <span class="fu">c</span>(<span class="fu">summary</span>(mod_A)<span class="sc">$</span>r.squared,     <span class="fu">summary</span>(mod_A0)<span class="sc">$</span>r.squared,     </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>             <span class="fu">summary</span>(mod_log)<span class="sc">$</span>r.squared),</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_aj  =</span> <span class="fu">c</span>(<span class="fu">summary</span>(mod_A)<span class="sc">$</span>adj.r.squared, <span class="fu">summary</span>(mod_A0)<span class="sc">$</span>adj.r.squared, </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>             <span class="fu">summary</span>(mod_log)<span class="sc">$</span>adj.r.squared),</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">AIC    =</span> <span class="fu">c</span>(<span class="fu">AIC</span>(mod_A), <span class="fu">AIC</span>(mod_A0), <span class="fu">AIC</span>(mod_log)),</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">BIC    =</span> <span class="fu">c</span>(<span class="fu">BIC</span>(mod_A), <span class="fu">BIC</span>(mod_A0), <span class="fu">BIC</span>(mod_log))</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>cmp1</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  Modelo                      R2 R2_aj   AIC   BIC
  &lt;chr&gt;                    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 A: Y~X (c/ intercepto)   0.942 0.941 134.  140. 
2 A0: Y~X (sem intercepto) 0.945 0.944 247.  251. 
3 B: log(Y)~X              0.936 0.935 -95.1 -89.4</code></pre>
</div>
</div>
<p>Lembre-se que um <span class="math inline">\(R^2\)</span> elevado pode coexistir com <strong>resíduos ruins</strong>. Isso acontece porque <span class="math inline">\(R^2\)</span> mede “quanto o modelo explica” em termos de variabilidade total, mas não garante que as hipóteses do MRLS estejam razoavelmente satisfeitas. Em particular, um modelo pode ter alto <span class="math inline">\(R^2\)</span> e ainda assim produzir inferências pouco confiáveis (erros-padrão distorcidos).</p>
<p><strong>Comentários:</strong><br>
- O <strong>Modelo A0</strong> apresenta <span class="math inline">\(R^2\)</span> elevado, mas penalizações via AIC/BIC mostram que é muito inferior (valores bem maiores). Logo, acredita-se que os coeficientes ficaram distorcidos, superestimando a inclinação.<br>
- O <strong>Modelo A</strong> combina bom ajuste (<span class="math inline">\(R^2_{aj}\)</span> alto) e parcimônia.<br>
- O <strong>Modelo B (log)</strong> apresenta os menores valores de AIC/BIC.</p>
<ol start="22" type="a">
<li><strong>Diagnóstico gráfico comparativo</strong></li>
</ol>
<p><strong>Dispersões com retas ajustadas dos dois modelos restantes</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dplyr)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tidyr)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>dfA  <span class="ot">&lt;-</span> df1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">valor =</span> Y,        <span class="at">modelo =</span> <span class="st">"A: Y ~ X (c/ intercepto)"</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>dfA0 <span class="ot">&lt;-</span> df1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">valor =</span> Y,        <span class="at">modelo =</span> <span class="st">"A0: Y ~ X (sem intercepto)"</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>dfB  <span class="ot">&lt;-</span> df1 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">valor =</span> <span class="fu">log</span>(Y),   <span class="at">modelo =</span> <span class="st">"B: log(Y) ~ X"</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>df_plot <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(dfA, dfA0, dfB)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_plot, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> valor)) <span class="sc">+</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.9</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>modelo, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"X"</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mrls_compara_files/figure-html/CHUNK_CM_07_NEW-1.png" class="img-fluid figure-img" width="1140"></p>
<figcaption>Exemplo 1 — Dispersão com reta OLS: Modelo A (Y~X, com intercepto), Modelo A0 (Y~X, sem intercepto) e Modelo B (log(Y)~X).</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Comentários:</strong><br>
- Em ambos os <strong>Modelos (A e B)</strong>, não observa-se aumento relevante da variabilidade de <span class="math inline">\(Y\)</span> conforme <span class="math inline">\(X\)</span> cresce.</p>
<p><strong>Resíduos vs.&nbsp;valores ajustados</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dplyr)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">fit =</span> <span class="fu">fitted</span>(mod_A),   <span class="at">res =</span> <span class="fu">resid</span>(mod_A),   <span class="at">modelo =</span> <span class="st">"A: Y ~ X (c/ intercepto)"</span>),</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">fit =</span> <span class="fu">fitted</span>(mod_A0),  <span class="at">res =</span> <span class="fu">resid</span>(mod_A0),  <span class="at">modelo =</span> <span class="st">"A0: Y ~ X (sem intercepto)"</span>),</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">fit =</span> <span class="fu">fitted</span>(mod_log), <span class="at">res =</span> <span class="fu">resid</span>(mod_log), <span class="at">modelo =</span> <span class="st">"B: log(Y) ~ X"</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dados, <span class="fu">aes</span>(<span class="at">x =</span> fit, <span class="at">y =</span> res)) <span class="sc">+</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.9</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>modelo, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Ajustados"</span>, <span class="at">y =</span> <span class="st">"Resíduo"</span>) <span class="sc">+</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mrls_compara_files/figure-html/CHUNK_CM_08_NEW-1.png" class="img-fluid figure-img" width="1140"></p>
<figcaption>Exemplo 1 — Resíduos vs Ajustados: comparação entre A, A0 e B.</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Comentário:</strong><br>
Neste gráfico, buscamos uma nuvem aproximadamente aleatória em torno de 0. Três estruturas são especialmente informativas:</p>
<ul>
<li><strong>Funil</strong> (dispersão aumentando/diminuindo com o nível ajustado): sinal de <strong>heteroscedasticidade</strong>.<br>
</li>
<li><strong>Curvatura</strong> (padrão em arco): sinal de <strong>forma funcional inadequada</strong> (não linearidade não capturada).<br>
</li>
<li><strong>Faixas</strong> (bandas horizontais): podem surgir por discretização/limitação de medida em <span class="math inline">\(Y\)</span>.</li>
</ul>
<p>Na comparação entre modelos, o melhor candidato é o que <em>reduz</em> essas estruturas, sem criar novas.</p>
<p><strong>Resíduos estudentizados vs.&nbsp;valores ajustados</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dplyr)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">fit =</span> <span class="fu">fitted</span>(mod_A),   <span class="at">stud =</span> <span class="fu">rstudent</span>(mod_A),   <span class="at">modelo =</span> <span class="st">"A: Y ~ X (c/ intercepto)"</span>),</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">fit =</span> <span class="fu">fitted</span>(mod_A0),  <span class="at">stud =</span> <span class="fu">rstudent</span>(mod_A0),  <span class="at">modelo =</span> <span class="st">"A0: Y ~ X (sem intercepto)"</span>),</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">fit =</span> <span class="fu">fitted</span>(mod_log), <span class="at">stud =</span> <span class="fu">rstudent</span>(mod_log), <span class="at">modelo =</span> <span class="st">"B: log(Y) ~ X"</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dados, <span class="fu">aes</span>(<span class="at">x =</span> fit, <span class="at">y =</span> stud)) <span class="sc">+</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.9</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>,  <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>modelo, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Ajustados"</span>, <span class="at">y =</span> <span class="st">"t* (estudentizado)"</span>) <span class="sc">+</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mrls_compara_files/figure-html/CHUNK_CM_09_NEW-1.png" class="img-fluid figure-img" width="1140"></p>
<figcaption>Exemplo 1 — Resíduos estudentizados vs Ajustados: comparação entre A, A0 e B.</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Comentário:</strong><br>
Estes gráficos apresentam informações similares aos ilustradas nos gráficos anteriores</p>
<p><strong>QQ-plot dos resíduos</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># dados do QQ-plot + parâmetros da reta ao estilo qqline (base R)</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>qq_df_line <span class="ot">&lt;-</span> <span class="cf">function</span>(mod, modelo){</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">rstandard</span>(mod)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  q <span class="ot">&lt;-</span> <span class="fu">qqnorm</span>(r, <span class="at">plot.it =</span> <span class="cn">FALSE</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">theo =</span> q<span class="sc">$</span>x, <span class="at">samp =</span> q<span class="sc">$</span>y, <span class="at">modelo =</span> modelo)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mesma regra do qqline: reta baseada nos quartis (25% e 75%)</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  yq <span class="ot">&lt;-</span> <span class="fu">quantile</span>(r, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  xq <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>))</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  slope <span class="ot">&lt;-</span> (yq[<span class="dv">2</span>] <span class="sc">-</span> yq[<span class="dv">1</span>])<span class="sc">/</span>(xq[<span class="dv">2</span>] <span class="sc">-</span> xq[<span class="dv">1</span>])</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  intercept <span class="ot">&lt;-</span> yq[<span class="dv">1</span>] <span class="sc">-</span> slope<span class="sc">*</span>xq[<span class="dv">1</span>]</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">df =</span> df, <span class="at">line =</span> <span class="fu">tibble</span>(<span class="at">modelo =</span> modelo, <span class="at">intercept =</span> intercept, <span class="at">slope =</span> slope))</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>outA  <span class="ot">&lt;-</span> <span class="fu">qq_df_line</span>(mod_A,   <span class="st">"A: Y ~ X (c/ intercepto)"</span>)</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>outA0 <span class="ot">&lt;-</span> <span class="fu">qq_df_line</span>(mod_A0,  <span class="st">"A0: Y ~ X (sem intercepto)"</span>)</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>outB  <span class="ot">&lt;-</span> <span class="fu">qq_df_line</span>(mod_log, <span class="st">"B: log(Y) ~ X"</span>)</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(outA<span class="sc">$</span>df, outA0<span class="sc">$</span>df, outB<span class="sc">$</span>df)</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>linhas <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(outA<span class="sc">$</span>line, outA0<span class="sc">$</span>line, outB<span class="sc">$</span>line)</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dados, <span class="fu">aes</span>(<span class="at">x =</span> theo, <span class="at">y =</span> samp)) <span class="sc">+</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.9</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">data =</span> linhas, <span class="fu">aes</span>(<span class="at">intercept =</span> intercept, <span class="at">slope =</span> slope),</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>modelo, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Quantis teoricos (Normal)"</span>,</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Residuos padronizados"</span>) <span class="sc">+</span></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mrls_compara_files/figure-html/CHUNK_CM_10_NEW-1.png" class="img-fluid figure-img" width="1140"></p>
<figcaption>Exemplo 1 — QQ-plot (rstandard) com reta tipo qqline: comparação entre A, A0 e B.</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Comentário:</strong><br>
O QQ-plot avalia <em>normalidade aproximada</em> por meio do alinhamento entre os quantis amostrais dos resíduos e os quantis teóricos da Normal. A interpretação deve ser feita por padrões:</p>
<ul>
<li><strong>Alinhamento global próximo da reta</strong>: evidência visual a favor de resíduos aproximadamente normais (pelo menos no “miolo” da distribuição).<br>
</li>
<li><strong>Desvios sistemáticos nas caudas</strong> (pontos afastando-se da reta apenas no início e no fim): indicam <strong>caudas mais pesadas ou mais leves</strong> que a Normal; isso costuma afetar sobretudo inferência em amostras pequenas.<br>
</li>
<li><strong>Padrão em “S”</strong>: sugere <strong>assimetria</strong> (skewness diferente de 0).<br>
</li>
<li><strong>Um ou poucos pontos muito afastados</strong>: podem ser indício de <strong>outliers</strong> (verificar também resíduos estudentizados e Cook).</li>
</ul>
<p>Ao comparar modelos, prefira o que apresenta <strong>menos estrutura sistemática</strong> no QQ-plot, especialmente quando isso é coerente com as medidas numéricas de assimetria/curtose e com testes como Jarque–Bera.</p>
<p><strong>Histograma dos resíduos</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dplyr)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">r =</span> <span class="fu">resid</span>(mod_A),   <span class="at">modelo =</span> <span class="st">"A: Y ~ X (c/ intercepto)"</span>),</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">r =</span> <span class="fu">resid</span>(mod_A0),  <span class="at">modelo =</span> <span class="st">"A0: Y ~ X (sem intercepto)"</span>),</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">r =</span> <span class="fu">resid</span>(mod_log), <span class="at">modelo =</span> <span class="st">"B: log(Y) ~ X"</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dados, <span class="fu">aes</span>(<span class="at">x =</span> r)) <span class="sc">+</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">12</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>modelo, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Resíduo"</span>, <span class="at">y =</span> <span class="st">"Frequência"</span>) <span class="sc">+</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mrls_compara_files/figure-html/CHUNK_CM_11_NEW-1.png" class="img-fluid figure-img" width="1140"></p>
<figcaption>Exemplo 1 — Histograma dos resíduos: comparação entre A, A0 e B.</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Comentário:</strong><br>
</p>
<p>O histograma é um diagnóstico auxiliar: ele ajuda a visualizar <strong>assimetria</strong> e <strong>caudas</strong>. Em geral:</p>
<ul>
<li>histograma muito assimétrico sugere assimetria nos resíduos;<br>
</li>
<li>caudas longas ou “ombros” podem sugerir caudas pesadas e/ou outliers.</li>
</ul>
<p>A interpretação deve ser combinada com QQ-plot e com medidas como assimetria/curtose.</p>
<p><strong>Resíduos vs.&nbsp;X</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dplyr)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">X =</span> df1<span class="sc">$</span>X, <span class="at">res =</span> <span class="fu">resid</span>(mod_A),   <span class="at">modelo =</span> <span class="st">"A: Y ~ X (c/ intercepto)"</span>),</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">X =</span> df1<span class="sc">$</span>X, <span class="at">res =</span> <span class="fu">resid</span>(mod_A0),  <span class="at">modelo =</span> <span class="st">"A0: Y ~ X (sem intercepto)"</span>),</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">X =</span> df1<span class="sc">$</span>X, <span class="at">res =</span> <span class="fu">resid</span>(mod_log), <span class="at">modelo =</span> <span class="st">"B: log(Y) ~ X"</span>)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dados, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> res)) <span class="sc">+</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.9</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>modelo, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"X"</span>, <span class="at">y =</span> <span class="st">"Resíduo"</span>) <span class="sc">+</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mrls_compara_files/figure-html/CHUNK_CM_12_NEW-1.png" class="img-fluid figure-img" width="1140"></p>
<figcaption>Exemplo 1 — Resíduos vs X: comparação entre A, A0 e B.</figcaption>
</figure>
</div>
</div>
</div>
<p><strong>Comentário:</strong><br>
- Ambos os <strong>Modelos (A e B)</strong> apresentam dispersão uniforme em torno de zero, corroborando a homocedasticidade.</p>
<p>O diagnóstico gráfico serve como “primeira triagem”: se houver funil, curvatura ou caudas muito pesadas, isso aparece visualmente de modo imediato. Somente depois disso faz sentido dar peso às comparações numéricas.</p>
<ol start="6" type="i">
<li><strong>Conclusões do exemplo</strong></li>
</ol>
<ul>
<li>O modelo sem intercepto tende a se ajustar mal, pois ignora o consumo em stand-by. Este modelo foi descartado no teste com modelo aninhados.<br>
</li>
<li>O modelo com intercepto melhora substancialmente o ajuste quando comparado com o modelo sem intercepto.<br>
</li>
<li>Assim como o modelo com intercepto (A), o modelo com variável transformada (B) também mostrou um bom ajuste.<br>
</li>
<li>Os resíduos dos modelos A e B mostraram que podemos considerar que ambos os modelos foram bem especificados.<br>
</li>
<li>O modelo B apresentou AIC/BIC menores. No entanto, como apresentado anteriormente, não é correto comparar diretamente os valores de um modelo ajustado em <span class="math inline">\(Y\)</span> com outro ajustado em <span class="math inline">\(\log(Y)\)</span>, pois a verossimilhança é diferente.<br>
</li>
<li>Considerando que os modelos A e B foram bem especificados e nao teve uma métrica de qualidade de ajuste muito favorável a um deles, é aconselhado o uso do modelo mais simples e na escala original da variável (Modelo A - com intercepto).</li>
</ul>
</section>
<section id="exemplo-2-escolhendo-a-melhor-variável-explicativa" class="level3" data-number="10.4.2">
<h3 data-number="10.4.2" class="anchored" data-anchor-id="exemplo-2-escolhendo-a-melhor-variável-explicativa"><span class="header-section-number">10.4.2</span> Exemplo 2 — Escolhendo a melhor variável explicativa</h3>
<ol type="i">
<li><strong>Cenário e modelos candidatos</strong> um pesquisador deseja explicar a produtividade agrícola (<span class="math inline">\(Y\)</span>) a partir de três variáveis candidatas:</li>
</ol>
<ul>
<li><span class="math inline">\(X_1\)</span> = quantidade de fertilizante aplicada (kg/ha)<br>
</li>
<li><span class="math inline">\(X_2\)</span> = volume de irrigação (mm)<br>
</li>
<li><span class="math inline">\(X_3\)</span> = horas de sol na safra (h)</li>
</ul>
<p>O objetivo é descobrir <strong>qual dessas variáveis explica melhor</strong> <span class="math inline">\(Y\)</span> de forma individual.</p>
<p>Os três MRLS candidatos são:</p>
<ol type="1">
<li><strong>Modelo A:</strong> <span class="math inline">\(Y = \beta_0 + \beta_1 X_1 + \varepsilon\)</span><br>
</li>
<li><strong>Modelo B:</strong> <span class="math inline">\(Y = \beta_0 + \beta_2 X_2 + \varepsilon\)</span><br>
</li>
<li><strong>Modelo C:</strong> <span class="math inline">\(Y = \beta_0 + \beta_3 X_3 + \varepsilon\)</span></li>
</ol>
<p><strong>Passos da análise comparativa:</strong></p>
<ol type="1">
<li><strong>Ajuste de cada modelo</strong> separadamente.<br>
</li>
<li><strong>Diagnóstico dos resíduos</strong> em cada caso, verificando linearidade, homoscedasticidade e normalidade.<br>
</li>
<li><strong>Comparação de medidas de ajuste</strong>: <span class="math inline">\(R^2\)</span>, <span class="math inline">\(R^2_{aj}\)</span>, AIC e BIC.<br>
</li>
<li><strong>Discussão substantiva</strong>: qual variável faz mais sentido teoricamente como explicativa de <span class="math inline">\(Y\)</span>.</li>
</ol>
<p><strong>Critérios práticos de decisão:</strong><br>
- Se todos os modelos tiverem resíduos adequados, a comparação pode ser feita pelos critérios formais (AIC/BIC, <span class="math inline">\(R^2_{aj}\)</span>).<br>
- Se apenas um modelo tiver resíduos consistentes com as hipóteses do MRLS, ele deve ser preferido.<br>
- Mesmo que dois modelos apresentem ajustes estatisticamente próximos, a escolha deve considerar a <strong>interpretação prática</strong>.</p>
<ol start="2" type="i">
<li><strong>Simulação dos dados</strong></li>
</ol>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dplyr)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulação: produtividade (Y) explicada por X1, X2, X3 (candidatas)</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">120</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n2,   <span class="dv">0</span>, <span class="dv">100</span>)   <span class="co"># fertilizante, 0–100 kg/ha</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n2,   <span class="dv">0</span>,  <span class="dv">60</span>)   <span class="co"># irrigação, 0–60 mm</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>X3 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n2, <span class="dv">200</span>, <span class="dv">350</span>)   <span class="co"># horas de sol, 200–350 h</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Verdade de geração</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>Y2 <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="sc">+</span> <span class="fl">0.45</span><span class="sc">*</span>X1 <span class="sc">+</span> <span class="fl">0.12</span><span class="sc">*</span>X2 <span class="sc">+</span> <span class="fl">0.02</span><span class="sc">*</span>X3 <span class="sc">+</span> <span class="fu">rnorm</span>(n2, <span class="dv">0</span>, <span class="dv">10</span>)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Y =</span> Y2, <span class="at">X1 =</span> X1, <span class="at">X2 =</span> X2, <span class="at">X3 =</span> X3)</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df2)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
      Y    X1    X2    X3
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  68.4  73.3  43.4  239.
2  59.9  47.6  39.9  245.
3  67.5  51.4  44.3  229.
4  59.2  49.8  33.2  332.
5  49.9  78.0  41.1  250.
6  42.0  50.4  43.0  241.</code></pre>
</div>
</div>
<p>Neste exemplo, as três variáveis candidatas têm escalas diferentes, mas isso não impede o ajuste de três MRLS separados. O que muda é a interpretação dos coeficientes e a magnitude dos erros-padrão. Como o objetivo é “melhor preditor individual”, estamos comparando <strong>três modelos alternativos não aninhados</strong>.</p>
<p>Este exemplo buscar mostrar que, mesmo no contexto de MRLS, a comparação entre variáveis explicativas pode guiar a seleção do <strong>melhor preditor individual</strong>.</p>
<ol start="3" type="i">
<li><strong>Roteiro de tarefas (atividade guiada)</strong></li>
</ol>
<!-- -->
<ol type="1">
<li><strong>Ajuste os três modelos candidatos</strong> separadamente:
<ul>
<li>Modelo A: $ Y = _0 + _1 X_1 + $<br>
</li>
<li>Modelo B: $ Y = _0 + _2 X_2 + $</li>
<li>Modelo C: $ Y = _0 + _3 X_3 + $</li>
</ul></li>
<li><strong>Inspecione os resíduos</strong> de cada modelo:
<ul>
<li>Gráficos de resíduos versus ajustados.<br>
</li>
<li>QQ-plot para verificar normalidade.<br>
</li>
<li>Histograma dos resíduos.<br>
</li>
<li>Resíduos versus a variável explicativa <span class="math inline">\(X\)</span>.</li>
</ul></li>
<li><strong>Compare as medidas de ajuste</strong> entre os modelos:
<ul>
<li><span class="math inline">\(R^2_{aj}\)</span> (ajustado)<br>
</li>
<li>AIC<br>
</li>
<li>BIC</li>
</ul></li>
<li><strong>Discuta os resultados obtidos</strong>:
<ul>
<li>Qual modelo apresentou resíduos mais consistentes com as hipóteses do MRLS?<br>
</li>
<li>Qual modelo apresentou melhor desempenho segundo <span class="math inline">\(R^2_{aj}\)</span>, AIC e BIC?<br>
</li>
<li>Existe coerência entre os diagnósticos gráficos e as medidas numéricas?</li>
</ul></li>
<li><strong>Reflexão substantiva:</strong>
<ul>
<li>Do ponto de vista prático, qual variável é a melhor candidata a explicar a produtividade agrícola (<span class="math inline">\(Y\)</span>) individualmente e por quê?<br>
</li>
<li>Considere plausibilidade causal e relevância no contexto agrícola (fertilizante, irrigação ou horas de sol).</li>
</ul></li>
<li><strong>Desafio opcional:</strong>
<ul>
<li>Re-simule os dados com outro <em>seed</em> ou altere o nível de ruído.<br>
</li>
<li>Observe se a escolha do melhor modelo permanece a mesma ou se muda.</li>
</ul></li>
</ol>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajustes dos três MRLS candidatos</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1, <span class="at">data =</span> df2)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X2, <span class="at">data =</span> df2)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X3, <span class="at">data =</span> df2)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"=== Modelo A: Y ~ X1 ===</span><span class="sc">\n</span><span class="st">"</span>); <span class="fu">print</span>(<span class="fu">summary</span>(m1))</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== Modelo A: Y ~ X1 ===</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Y ~ X1, data = df2)

Residuals:
     Min       1Q   Median       3Q      Max 
-30.5982  -6.0204   0.6442   6.9029  27.5385 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 31.49842    1.84972   17.03   &lt;2e-16 ***
X1           0.41940    0.03076   13.63   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 9.73 on 118 degrees of freedom
Multiple R-squared:  0.6117,    Adjusted R-squared:  0.6084 
F-statistic: 185.9 on 1 and 118 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Modelo B: Y ~ X2 ===</span><span class="sc">\n</span><span class="st">"</span>); <span class="fu">print</span>(<span class="fu">summary</span>(m2))</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Modelo B: Y ~ X2 ===</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Y ~ X2, data = df2)

Residuals:
    Min      1Q  Median      3Q     Max 
-45.332 -10.528   2.142  12.276  35.247 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 47.69985    2.63414  18.108  &lt; 2e-16 ***
X2           0.19641    0.07436   2.641  0.00937 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 15.17 on 118 degrees of freedom
Multiple R-squared:  0.05583,   Adjusted R-squared:  0.04783 
F-statistic: 6.977 on 1 and 118 DF,  p-value: 0.009374</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">=== Modelo C: Y ~ X3 ===</span><span class="sc">\n</span><span class="st">"</span>); <span class="fu">print</span>(<span class="fu">summary</span>(m3))</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== Modelo C: Y ~ X3 ===</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Y ~ X3, data = df2)

Residuals:
    Min      1Q  Median      3Q     Max 
-49.032 -12.257   1.166  11.872  31.353 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 58.31156    8.78394   6.638 1.02e-09 ***
X3          -0.01715    0.03168  -0.541    0.589    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 15.59 on 118 degrees of freedom
Multiple R-squared:  0.002478,  Adjusted R-squared:  -0.005975 
F-statistic: 0.2932 on 1 and 118 DF,  p-value: 0.5892</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>cmp2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Modelo =</span> <span class="fu">c</span>(<span class="st">"A: Y~X1"</span>, <span class="st">"B: Y~X2"</span>, <span class="st">"C: Y~X3"</span>),</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2     =</span> <span class="fu">c</span>(<span class="fu">summary</span>(m1)<span class="sc">$</span>r.squared,     <span class="fu">summary</span>(m2)<span class="sc">$</span>r.squared,     <span class="fu">summary</span>(m3)<span class="sc">$</span>r.squared),</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_aj  =</span> <span class="fu">c</span>(<span class="fu">summary</span>(m1)<span class="sc">$</span>adj.r.squared, <span class="fu">summary</span>(m2)<span class="sc">$</span>adj.r.squared, <span class="fu">summary</span>(m3)<span class="sc">$</span>adj.r.squared),</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">AIC    =</span> <span class="fu">c</span>(<span class="fu">AIC</span>(m1), <span class="fu">AIC</span>(m2), <span class="fu">AIC</span>(m3)),</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">BIC    =</span> <span class="fu">c</span>(<span class="fu">BIC</span>(m1), <span class="fu">BIC</span>(m2), <span class="fu">BIC</span>(m3))</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>cmp2</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  Modelo       R2    R2_aj   AIC   BIC
  &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 A: Y~X1 0.612    0.608    891.  899.
2 B: Y~X2 0.0558   0.0478   997. 1006.
3 C: Y~X3 0.00248 -0.00598 1004. 1012.</code></pre>
</div>
</div>
<p><strong>Diagnóstico gráfico comparativo:</strong><br>
- dispersão <span class="math inline">\(Y\)</span> vs cada <span class="math inline">\(X_j\)</span> com reta OLS (um painel por modelo);<br>
- resíduos vs ajustados (um painel por modelo);<br>
- QQ-plot (um painel por modelo);<br>
- histograma dos resíduos (um painel por modelo);<br>
- resíduos vs <span class="math inline">\(X_j\)</span> (um painel por modelo).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(ggplot2)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(dplyr)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(tidyr)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Organizar dados em formato longo para facilitar facetas</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>long_xy <span class="ot">&lt;-</span> df2 <span class="sc">%&gt;%</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(X1, X2, X3), <span class="at">names_to =</span> <span class="st">"Xname"</span>, <span class="at">values_to =</span> <span class="st">"X"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">modelo =</span> <span class="fu">recode</span>(Xname, <span class="at">X1 =</span> <span class="st">"Modelo A: Y~X1"</span>, <span class="at">X2 =</span> <span class="st">"Modelo B: Y~X2"</span>, <span class="at">X3 =</span> <span class="st">"Modelo C: Y~X3"</span>))</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Função auxiliar para extrair resíduos e ajustados por modelo</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>aug1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">fit =</span> <span class="fu">fitted</span>(m1), <span class="at">res =</span> <span class="fu">resid</span>(m1), <span class="at">modelo =</span> <span class="st">"Modelo A: Y~X1"</span>)</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>aug2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">fit =</span> <span class="fu">fitted</span>(m2), <span class="at">res =</span> <span class="fu">resid</span>(m2), <span class="at">modelo =</span> <span class="st">"Modelo B: Y~X2"</span>)</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>aug3 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">fit =</span> <span class="fu">fitted</span>(m3), <span class="at">res =</span> <span class="fu">resid</span>(m3), <span class="at">modelo =</span> <span class="st">"Modelo C: Y~X3"</span>)</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>aug  <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(aug1, aug2, aug3)</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Y vs X com reta OLS</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(long_xy, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.85</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>modelo, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Y"</span>) <span class="sc">+</span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Resíduos vs ajustados</span></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(aug, <span class="fu">aes</span>(<span class="at">x =</span> fit, <span class="at">y =</span> res)) <span class="sc">+</span></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.85</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>modelo, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Ajustados"</span>, <span class="at">y =</span> <span class="st">"Resíduo"</span>) <span class="sc">+</span></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) QQ-plot (estilo plot.lm, which = 2)</span></span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>qq_df_lmstyle <span class="ot">&lt;-</span> <span class="cf">function</span>(mod, modelo){</span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">rstandard</span>(mod)                 <span class="co"># mesmo tipo de resíduo do plot.lm</span></span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>  q <span class="ot">&lt;-</span> <span class="fu">qqnorm</span>(r, <span class="at">plot.it =</span> <span class="cn">FALSE</span>)</span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>  pts <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">theo =</span> q<span class="sc">$</span>x,</span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">samp =</span> q<span class="sc">$</span>y,</span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">modelo =</span> modelo</span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># reta tipo qqline(): passa pelos quartis 25% e 75%</span></span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a>  yq <span class="ot">&lt;-</span> <span class="fu">quantile</span>(r, <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>))</span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a>  xq <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>))</span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a>  slope <span class="ot">&lt;-</span> (yq[<span class="dv">2</span>] <span class="sc">-</span> yq[<span class="dv">1</span>])<span class="sc">/</span>(xq[<span class="dv">2</span>] <span class="sc">-</span> xq[<span class="dv">1</span>])</span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a>  intercept <span class="ot">&lt;-</span> yq[<span class="dv">1</span>] <span class="sc">-</span> slope<span class="sc">*</span>xq[<span class="dv">1</span>]</span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-52"><a href="#cb47-52" aria-hidden="true" tabindex="-1"></a>  line <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb47-53"><a href="#cb47-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">modelo =</span> modelo,</span>
<span id="cb47-54"><a href="#cb47-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">intercept =</span> <span class="fu">as.numeric</span>(intercept),</span>
<span id="cb47-55"><a href="#cb47-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">slope =</span> <span class="fu">as.numeric</span>(slope)</span>
<span id="cb47-56"><a href="#cb47-56" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-57"><a href="#cb47-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-58"><a href="#cb47-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">pts =</span> pts, <span class="at">line =</span> line)</span>
<span id="cb47-59"><a href="#cb47-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-60"><a href="#cb47-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-61"><a href="#cb47-61" aria-hidden="true" tabindex="-1"></a>o1 <span class="ot">&lt;-</span> <span class="fu">qq_df_lmstyle</span>(m1, <span class="st">"Modelo A: Y~X1"</span>)</span>
<span id="cb47-62"><a href="#cb47-62" aria-hidden="true" tabindex="-1"></a>o2 <span class="ot">&lt;-</span> <span class="fu">qq_df_lmstyle</span>(m2, <span class="st">"Modelo B: Y~X2"</span>)</span>
<span id="cb47-63"><a href="#cb47-63" aria-hidden="true" tabindex="-1"></a>o3 <span class="ot">&lt;-</span> <span class="fu">qq_df_lmstyle</span>(m3, <span class="st">"Modelo C: Y~X3"</span>)</span>
<span id="cb47-64"><a href="#cb47-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-65"><a href="#cb47-65" aria-hidden="true" tabindex="-1"></a>qq_all  <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(o1<span class="sc">$</span>pts,  o2<span class="sc">$</span>pts,  o3<span class="sc">$</span>pts)</span>
<span id="cb47-66"><a href="#cb47-66" aria-hidden="true" tabindex="-1"></a>qq_line <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(o1<span class="sc">$</span>line, o2<span class="sc">$</span>line, o3<span class="sc">$</span>line)</span>
<span id="cb47-67"><a href="#cb47-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-68"><a href="#cb47-68" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(qq_all, <span class="fu">aes</span>(<span class="at">x =</span> theo, <span class="at">y =</span> samp)) <span class="sc">+</span></span>
<span id="cb47-69"><a href="#cb47-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.85</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb47-70"><a href="#cb47-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(</span>
<span id="cb47-71"><a href="#cb47-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> qq_line,</span>
<span id="cb47-72"><a href="#cb47-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">intercept =</span> intercept, <span class="at">slope =</span> slope),</span>
<span id="cb47-73"><a href="#cb47-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.8</span></span>
<span id="cb47-74"><a href="#cb47-74" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb47-75"><a href="#cb47-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>modelo, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb47-76"><a href="#cb47-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Quantis teóricos (Normal)"</span>, <span class="at">y =</span> <span class="st">"Resíduos padronizados"</span>) <span class="sc">+</span></span>
<span id="cb47-77"><a href="#cb47-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb47-78"><a href="#cb47-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-79"><a href="#cb47-79" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) Histogramas dos resíduos</span></span>
<span id="cb47-80"><a href="#cb47-80" aria-hidden="true" tabindex="-1"></a>res_all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb47-81"><a href="#cb47-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">r =</span> <span class="fu">resid</span>(m1), <span class="at">modelo =</span> <span class="st">"Modelo A: Y~X1"</span>),</span>
<span id="cb47-82"><a href="#cb47-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">r =</span> <span class="fu">resid</span>(m2), <span class="at">modelo =</span> <span class="st">"Modelo B: Y~X2"</span>),</span>
<span id="cb47-83"><a href="#cb47-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">r =</span> <span class="fu">resid</span>(m3), <span class="at">modelo =</span> <span class="st">"Modelo C: Y~X3"</span>)</span>
<span id="cb47-84"><a href="#cb47-84" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-85"><a href="#cb47-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-86"><a href="#cb47-86" aria-hidden="true" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(res_all, <span class="fu">aes</span>(<span class="at">x =</span> r)) <span class="sc">+</span></span>
<span id="cb47-87"><a href="#cb47-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">12</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb47-88"><a href="#cb47-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>modelo, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb47-89"><a href="#cb47-89" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Resíduo"</span>, <span class="at">y =</span> <span class="st">"Frequência"</span>) <span class="sc">+</span></span>
<span id="cb47-90"><a href="#cb47-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb47-91"><a href="#cb47-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-92"><a href="#cb47-92" aria-hidden="true" tabindex="-1"></a><span class="co"># 5) Resíduos vs X (por modelo)</span></span>
<span id="cb47-93"><a href="#cb47-93" aria-hidden="true" tabindex="-1"></a>rx <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb47-94"><a href="#cb47-94" aria-hidden="true" tabindex="-1"></a>  df2 <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(<span class="at">X =</span> X1, <span class="at">res =</span> <span class="fu">resid</span>(m1), <span class="at">modelo =</span> <span class="st">"Modelo A: Y~X1"</span>),</span>
<span id="cb47-95"><a href="#cb47-95" aria-hidden="true" tabindex="-1"></a>  df2 <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(<span class="at">X =</span> X2, <span class="at">res =</span> <span class="fu">resid</span>(m2), <span class="at">modelo =</span> <span class="st">"Modelo B: Y~X2"</span>),</span>
<span id="cb47-96"><a href="#cb47-96" aria-hidden="true" tabindex="-1"></a>  df2 <span class="sc">%&gt;%</span> <span class="fu">transmute</span>(<span class="at">X =</span> X3, <span class="at">res =</span> <span class="fu">resid</span>(m3), <span class="at">modelo =</span> <span class="st">"Modelo C: Y~X3"</span>)</span>
<span id="cb47-97"><a href="#cb47-97" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-98"><a href="#cb47-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-99"><a href="#cb47-99" aria-hidden="true" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rx, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> res)) <span class="sc">+</span></span>
<span id="cb47-100"><a href="#cb47-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.85</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb47-101"><a href="#cb47-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb47-102"><a href="#cb47-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>modelo, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">scales =</span> <span class="st">"free_x"</span>) <span class="sc">+</span></span>
<span id="cb47-103"><a href="#cb47-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Resíduo"</span>) <span class="sc">+</span></span>
<span id="cb47-104"><a href="#cb47-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">12</span>)</span>
<span id="cb47-105"><a href="#cb47-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-106"><a href="#cb47-106" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar os 5 gráficos (um por vez, na ordem)</span></span>
<span id="cb47-107"><a href="#cb47-107" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mrls_compara_files/figure-html/CHUNK_CM_16-1.png" class="img-fluid figure-img" width="1140"></p>
<figcaption>Diagnóstico gráfico comparativo (Exemplo 2): cada linha corresponde a um modelo (A, B, C).</figcaption>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p2)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mrls_compara_files/figure-html/CHUNK_CM_16-2.png" class="img-fluid figure-img" width="1140"></p>
<figcaption>Diagnóstico gráfico comparativo (Exemplo 2): cada linha corresponde a um modelo (A, B, C).</figcaption>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p3)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mrls_compara_files/figure-html/CHUNK_CM_16-3.png" class="img-fluid figure-img" width="1140"></p>
<figcaption>Diagnóstico gráfico comparativo (Exemplo 2): cada linha corresponde a um modelo (A, B, C).</figcaption>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p4)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mrls_compara_files/figure-html/CHUNK_CM_16-4.png" class="img-fluid figure-img" width="1140"></p>
<figcaption>Diagnóstico gráfico comparativo (Exemplo 2): cada linha corresponde a um modelo (A, B, C).</figcaption>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p5)</span></code></pre></div><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mrls_compara_files/figure-html/CHUNK_CM_16-5.png" class="img-fluid figure-img" width="1140"></p>
<figcaption>Diagnóstico gráfico comparativo (Exemplo 2): cada linha corresponde a um modelo (A, B, C).</figcaption>
</figure>
</div>
</div>
</div>
<ul>
<li>Se um modelo “vence” nos critérios numéricos, mas apresenta funil/curvatura/caudas pesadas, ele deve perder força como candidato.<br>
</li>
<li>Se dois modelos forem próximos numericamente, a decisão pode depender do contexto (medição, causalidade plausível, custo de obter a variável, etc.).</li>
</ul>
<ol start="4" type="i">
<li><strong>Fechamento e síntese</strong></li>
</ol>
<p>Os dois exemplos mostraram situações complementares na prática do MRLS. O <strong>Exemplo 1</strong> destacou como diferentes especificações de um mesmo modelo, com intercepto, sem intercepto e com transformação em (Y), podem levar a conclusões distintas sobre ajuste, resíduos e interpretação. Já o <strong>Exemplo 2</strong> explorou a escolha entre diferentes variáveis candidatas, mostrando como a comparação de modelos separados orienta a seleção do preditor mais adequado.</p>
<p>Em conjunto, os exemplos reforçam que a escolha do modelo não deve se basear apenas em indicadores numéricos, mas sim no equilíbrio entre <strong>consistência estatística, parcimônia e coerência substantiva</strong> com o fenômeno estudado.</p>


<div id="refs" class="references csl-bib-body" data-entry-spacing="1" role="list" style="display: none">
<div id="ref-akaike1974" class="csl-entry" role="listitem">
AKAIKE, Hirotugu. A new look at the statistical model identification. <strong>IEEE Transactions on Automatic Control</strong>, v. 19, n. 6, p. 716–723, 1974.
</div>
<div id="ref-burnham2002" class="csl-entry" role="listitem">
BURNHAM, Kenneth P.; ANDERSON, David R. <strong>Model Selection and Multimodel Inference: A Practical Information-Theoretic Approach</strong>. 2. ed. New York: Springer, 2002.
</div>
<div id="ref-schwarz1978" class="csl-entry" role="listitem">
SCHWARZ, Gideon. Estimating the Dimension of a Model. <strong>The Annals of Statistics</strong>, v. 6, n. 2, p. 461–464, 1978.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiada");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiada");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./mrls_transf.html" class="pagination-link" aria-label="Transformações nas Variáveis">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Transformações nas Variáveis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./part2_ex.html" class="pagination-link" aria-label="Exercícios e Atividades de Consolidação">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Exercícios e Atividades de Consolidação</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>